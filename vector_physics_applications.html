<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vector Physics Applications</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: var(--dark-color);
            padding-top: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .navigation-buttons {
            position: absolute;
            top: 120px;
            right: 500px;
            display: flex;
            gap: 20px;
        }
        
        .nav-btn {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: all 0.3s;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .nav-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0 !important;
            padding: 1rem 1.5rem;
            font-weight: 600;
        }
        
        .canvas-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .input-group {
            margin-bottom: 1rem;
        }
        
        .vector-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .vector-input input {
            width: 80px;
        }
        
        .result-box {
            background-color: var(--light-color);
            padding: 1rem;
            border-radius: 5px;
            margin-top: 1rem;
            font-weight: 600;
        }
        
        .nav-tabs .nav-link {
            color: var(--dark-color);
            font-weight: 500;
        }
        
        .nav-tabs .nav-link.active {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .tab-content {
            padding: 1.5rem;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 10px 10px;
        }
        
        h2 {
            color: var(--secondary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        footer {
            background-color: var(--secondary-color);
            color: white;
            padding: 1.5rem 0;
            margin-top: 3rem;
            border-radius: 10px;
        }
        
        .form-label {
            font-weight: 500;
        }
        
        .btn-calculate {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .btn-calculate:hover {
            background-color: #2980b9;
        }
        
        .force-input-group {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        /* AI Features Styling */
        .ai-features {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .ai-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }
        
        .ai-section h4 {
            color: var(--secondary-color);
            margin-bottom: 1rem;
        }
        
        .ai-button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: background-color 0.3s;
        }
        
        .ai-button:hover {
            background-color: #c0392b;
        }
        
        .ai-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .ai-response {
            background-color: var(--light-color);
            padding: 1rem;
            border-radius: 5px;
            margin-top: 1rem;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .step-explanation {
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background-color: white;
            border-left: 3px solid var(--primary-color);
        }
        
        .ai-thinking {
            font-style: italic;
            color: #7f8c8d;
        }
       /* Rocket styling */
        .rocket-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 1rem;
            position: relative;
            height: 80px;
        }
        
        .rocket {
            font-size: 2.5rem;
            position: absolute;
            top: 0;
        }
        
        .rocket-left {
            left: 0;
            animation: moveLeftToRight 5s linear infinite;
        }
        
        .rocket-right {
            right: 0;
            animation: moveRightToLeft 5s linear infinite;
        }
        
        @keyframes moveLeftToRight {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw - 100px)); }
        }
        
        @keyframes moveRightToLeft {
            0% { transform: translateX(calc(100vw - 100px)); }
            100% { transform: translateX(-100px); }
        }
        

        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @media (max-width: 768px) {
            .rocket {
                font-size: 2rem;
                margin: 0 10px;
            }
            
            .navigation-buttons {
                position: static;
                justify-content: center;
                margin-top: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header text-center">
          <div class="navigation-buttons">
    <a href="Vector_visulization.html" class="nav-btn">Back to Visualization</a>
    <a href="vectors_advanced_operations.html" class="nav-btn">Back to Advanced Operations</a>
    <a href="vector_3D_animations.html" class="nav-btn">3D Animations</a>
     <a href="ai_power_quiz.html" class="nav-btn">AI SUPER QUIZ</a>
</div>
            
            <div class="header-content">
                <div class="rocket rocket-left">🚀</div>
                <div>
                    <h1>Vector Physics Applications</h1>
                    <p class="lead">Interactive visualization of vector concepts in physics</p>
                </div>
                <div class="rocket rocket-right">🚀</div>
            </div>
        </div>
          <!-- AI Features Section -->
        <div class="ai-features">
            <h3>AI-Powered Learning Assistant</h3>
            
            <!-- Problem Generation -->
            <div class="ai-section">
                <h4>1. AI-Powered Problem Generation</h4>
                <p>Generate random physics problems with varying difficulty levels.</p>
                <button class="ai-button" onclick="generateProblem('easy')">Easy Problem</button>
                <button class="ai-button" onclick="generateProblem('medium')">Medium Problem</button>
                <button class="ai-button" onclick="generateProblem('hard')">Hard Problem</button>
                <div id="generated-problem" class="ai-response"></div>
            </div>
            
            <!-- Natural Language Input -->
            <div class="ai-section">
                <h4>2. Natural Language Input</h4>
                <p>Describe a physics problem in plain English:</p>
                <input type="text" id="nl-input" class="ai-input" placeholder="E.g., 'Find the work done by a force of 5N at 30 degrees over 10m'">
                <button class="ai-button" onclick="parseNaturalLanguage()">Parse Problem</button>
                <div id="nl-response" class="ai-response"></div>
            </div>
            
            <!-- Step-by-Step Explanations -->
            <div class="ai-section">
                <h4>3. Step-by-Step Solution Explanations</h4>
                <p>Get detailed explanations for the current calculation:</p>
                <button class="ai-button" onclick="explainCurrentCalculation()">Explain This Calculation</button>
                <div id="step-explanation" class="ai-response"></div>
            </div>
        </div>
        <div class="ai-features">
    <h3>AI-Generated Quiz & Assessment</h3>
    
    <!-- Quiz Generation -->
    <div class="ai-section">
        <h4>4. AI-Generated MiniQuiz</h4>
        <p>Take a personalized quiz based on your recent activity:</p>
        <button class="ai-button" onclick="generateQuiz()">Generate Quiz</button>
        <button class="ai-button" onclick="generateCustomQuiz()">Custom Quiz</button>
        
        <!-- Quiz Customization Options -->
        <div id="quiz-customization" style="display: none; margin-top: 15px;">
            <div class="mb-3">
                <label class="form-label">Number of Questions:</label>
                <input type="number" id="quiz-length" class="form-control" min="3" max="15" value="5">
            </div>
            <div class="mb-3">
                <label class="form-label">Difficulty:</label>
                <select id="quiz-difficulty" class="form-control">
                    <option value="easy">Easy</option>
                    <option value="medium" selected>Medium</option>
                    <option value="hard">Hard</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="form-label">Topics:</label>
                <div>
        <input type="checkbox" id="topic-work" checked> <label for="topic-work">Work</label>
        <input type="checkbox" id="topic-area" checked> <label for="topic-area">Area</label>
        <input type="checkbox" id="topic-torque" checked> <label for="topic-torque">Torque</label>
        <input type="checkbox" id="topic-normal"> <label for="topic-normal">Normal Vectors</label>
        <input type="checkbox" id="topic-velocity"> <label for="topic-velocity">Velocity</label>
        <input type="checkbox" id="topic-distance"> <label for="topic-distance">Distance</label>
        <input type="checkbox" id="topic-line"> <label for="topic-line">Line Equations</label>
        <input type="checkbox" id="topic-volume"> <label for="topic-volume">Volume</label> 
           </div>
            </div>
            <button class="ai-button" onclick="generateCustomQuiz()">Generate Custom Quiz</button>    
        </div>

        <!-- Quiz Interface -->
        <div id="quiz-interface" style="display: none; margin-top: 15px;">
            <div id="quiz-progress" class="mb-3">
                <div class="progress">
                    <div id="quiz-progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                </div>
                <small>Question <span id="current-question">1</span> of <span id="total-questions">5</span></small>
            </div>
            
            <div id="quiz-question" class="mb-3">
                <h5 id="question-text"></h5>
                <div id="question-options" class="mt-3"></div>
            </div>
            
            <div id="quiz-feedback" class="alert" style="display: none;"></div>
            
            <div id="quiz-controls">
                <button id="prev-question" class="ai-button" onclick="prevQuestion()" disabled>Previous</button>
                <button id="next-question" class="ai-button" onclick="nextQuestion()">Next</button>
                <button id="submit-quiz" class="ai-button" onclick="submitQuiz()" style="display: none;">Submit Quiz</button>
            </div>
        </div>
        
        <!-- Quiz Results -->
        <div id="quiz-results" style="display: none; margin-top: 15px;">
            <h5>Quiz Results</h5>
            <div class="result-box">
                <p>Score: <span id="quiz-score">0</span>/<span id="quiz-max-score">0</span> (<span id="quiz-percentage">0</span>%)</p>
                <p id="quiz-grade"></p>
                <p id="quiz-feedback-text"></p>
            </div>
            
            <div id="quiz-review" class="mt-3" style="display: none;">
                <h6>Question Review:</h6>
                <div id="question-review-list"></div>
            </div>
            
            <button class="ai-button" onclick="retakeQuiz()">Retake Quiz</button>
            <button class="ai-button" onclick="showQuizReview()" id="show-review-btn">Show Review</button>
        </div>
    </div>
           <div class="ai-features">
    <h3>AI Code Generator</h3>
    
    <!-- Code Generation -->
    <div class="ai-section">
        <h4>5. AI-Powered Code Generation</h4>
        <p>Generate code for vector operations in your preferred programming language:</p>
        
        <div class="mb-3">
            <label class="form-label">Select Programming Language:</label>
            <select id="code-language" class="form-control">
                <option value="c">C</option>
                <option value="cpp">C++</option>
                <option value="java">Java</option>
                <option value="python">Python</option>
            </select>
        </div>
        
        <div class="mb-3">
            <label class="form-label">Select Vector Operations:</label>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-vector-add" checked>
                        <label class="form-check-label" for="code-vector-add">Vector Addition</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-vector-sub">
                        <label class="form-check-label" for="code-vector-sub">Vector Subtraction</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-scalar-mul">
                        <label class="form-check-label" for="code-scalar-mul">Scalar Multiplication</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-dot-product">
                        <label class="form-check-label" for="code-dot-product">Dot Product</label>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-cross-product">
                        <label class="form-check-label" for="code-cross-product">Cross Product</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-vector-magnitude">
                        <label class="form-check-label" for="code-vector-magnitude">Vector Magnitude</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-vector-normalize">
                        <label class="form-check-label" for="code-vector-normalize">Vector Normalization</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="code-scalar-triple">
                        <label class="form-check-label" for="code-scalar-triple">Scalar Triple Product</label>
                    </div>
                </div>
            </div>
        </div>
        
        <button class="ai-button" onclick="generateCode()">Generate Code</button>
        <button class="ai-button" onclick="testGeneratedCode()">Test Code with Custom Inputs</button>
        
        <!-- Code Output -->
        <div id="code-output" class="ai-response" style="display: none;">
            <h5>Generated Code:</h5>
            <pre id="generated-code" class="bg-light p-3 border rounded"></pre>
            <button class="ai-button" onclick="copyCode()">Copy Code</button>
        </div>
        
        <!-- Test Interface -->
        <div id="code-test-interface" class="mt-3" style="display: none;">
            <h5>Test the Generated Code:</h5>
            <div id="test-inputs" class="mb-3"></div>
            <button class="ai-button" onclick="runCodeTest()">Run Test</button>
            <div id="test-results" class="mt-3"></div>
        </div>
    </div>
</div> 
<!-- Add this section to the AI Features area -->
<div class="ai-section">
    <h4>6. Real-Time Interactive Feedback</h4>
    <p>Get contextual hints and feedback as you work through problems:</p>
    
    <div class="mb-3">
        <label class="form-label">Enable Real-Time Feedback:</label>
        <input type="checkbox" id="enable-feedback" checked>
    </div>
    
    <div id="feedback-container" class="ai-response" style="display: none;">
        <h5>Contextual Feedback</h5>
        <div id="feedback-content">
            <p id="feedback-message">No active feedback. Start working on a problem to receive hints.</p>
        </div>
        <div id="hint-controls" style="margin-top: 10px;">
            <button class="ai-button" onclick="requestHint()" id="hint-button">Get Hint</button>
            <button class="ai-button" onclick="explainConcept()" id="explain-button">Explain Concept</button>
        </div>
    </div>
</div>


        <ul class="nav nav-tabs" id="physicsTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="work-tab" data-bs-toggle="tab" data-bs-target="#work" type="button" role="tab">Work Done</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="area-tab" data-bs-toggle="tab" data-bs-target="#area" type="button" role="tab">Area of Parallelogram</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="torque-tab" data-bs-toggle="tab" data-bs-target="#torque" type="button" role="tab">Torque</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="normal-tab" data-bs-toggle="tab" data-bs-target="#normal" type="button" role="tab">Normal Vectors</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="velocity-tab" data-bs-toggle="tab" data-bs-target="#velocity" type="button" role="tab">Resultant Velocity</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="line-tab" data-bs-toggle="tab" data-bs-target="#line" type="button" role="tab">Vector Equation of a Line</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="linear-tab" data-bs-toggle="tab" data-bs-target="#linear" type="button" role="tab">Linear Velocity</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="normalization-tab" data-bs-toggle="tab" data-bs-target="#normalization" type="button" role="tab">Vector Normalization</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="equilibrium-tab" data-bs-toggle="tab" data-bs-target="#equilibrium" type="button" role="tab">Equilibrium of Forces</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="distance-tab" data-bs-toggle="tab" data-bs-target="#distance" type="button" role="tab">Distance to a Plane</button>
            </li>
        </ul>
        
        <div class="tab-content" id="physicsTabContent">
            <!-- Work Done Tab -->
            <div class="tab-pane fade show active" id="work" role="tabpanel">
                <h2>Work Done</h2>
                <p>Work is calculated as the dot product of force and displacement vectors: W = F · d = |F||d|cosθ</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Force Vector (F)</label>
                                    <div class="vector-input">
                                        <input type="number" id="force-x" class="form-control" placeholder="X" value="5">
                                        <input type="number" id="force-y" class="form-control" placeholder="Y" value="3">
                                        <input type="number" id="force-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Displacement Vector (d)</label>
                                    <div class="vector-input">
                                        <input type="number" id="displacement-x" class="form-control" placeholder="X" value="2">
                                        <input type="number" id="displacement-y" class="form-control" placeholder="Y" value="4">
                                        <input type="number" id="displacement-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateWork()">Calculate Work</button>
                                
                                <div class="result-box">
                                    <p>Work Done: <span id="work-result">0</span> Joules</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="work-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the force vector (red) and displacement vector (blue). The work is proportional to the projection of force onto displacement.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Area of Parallelogram Tab -->
            <div class="tab-pane fade" id="area" role="tabpanel">
                <h2>Area of Parallelogram</h2>
                <p>The area of a parallelogram formed by two vectors is the magnitude of their cross product: A = |a × b|</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Vector A</label>
                                    <div class="vector-input">
                                        <input type="number" id="vector-a-x" class="form-control" placeholder="X" value="3">
                                        <input type="number" id="vector-a-y" class="form-control" placeholder="Y" value="2">
                                        <input type="number" id="vector-a-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Vector B</label>
                                    <div class="vector-input">
                                        <input type="number" id="vector-b-x" class="form-control" placeholder="X" value="1">
                                        <input type="number" id="vector-b-y" class="form-control" placeholder="Y" value="4">
                                        <input type="number" id="vector-b-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateArea()">Calculate Area</button>
                                
                                <div class="result-box">
                                    <p>Area of Parallelogram: <span id="area-result">0</span> square units</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="area-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows vectors A and B forming a parallelogram. The area is visualized as the shaded region.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Torque Tab -->
            <div class="tab-pane fade" id="torque" role="tabpanel">
                <h2>Torque</h2>
                <p>Torque is the cross product of position vector and force vector: τ = r × F</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Position Vector (r)</label>
                                    <div class="vector-input">
                                        <input type="number" id="position-x" class="form-control" placeholder="X" value="2">
                                        <input type="number" id="position-y" class="form-control" placeholder="Y" value="3">
                                        <input type="number" id="position-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Force Vector (F)</label>
                                    <div class="vector-input">
                                        <input type="number" id="torque-force-x" class="form-control" placeholder="X" value="4">
                                        <input type="number" id="torque-force-y" class="form-control" placeholder="Y" value="1">
                                        <input type="number" id="torque-force-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateTorque()">Calculate Torque</button>
                                
                                <div class="result-box">
                                    <p>Torque: <span id="torque-result">0</span> N·m</p>
                                    <p>Torque Vector: (<span id="torque-vector-x">0</span>, <span id="torque-vector-y">0</span>, <span id="torque-vector-z">0</span>)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="torque-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the position vector (green), force vector (red), and the resulting torque vector (purple) perpendicular to the plane.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Normal Vectors Tab -->
            <div class="tab-pane fade" id="normal" role="tabpanel">
                <h2>Normal Vectors</h2>
                <p>A normal vector is perpendicular to a surface. For a plane defined by two vectors, the normal is their cross product.</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Vector U (on the plane)</label>
                                    <div class="vector-input">
                                        <input type="number" id="normal-u-x" class="form-control" placeholder="X" value="3">
                                        <input type="number" id="normal-u-y" class="form-control" placeholder="Y" value="1">
                                        <input type="number" id="normal-u-z" class="form-control" placeholder="Z" value="2">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Vector V (on the plane)</label>
                                    <div class="vector-input">
                                        <input type="number" id="normal-v-x" class="form-control" placeholder="X" value="1">
                                        <input type="number" id="normal-v-y" class="form-control" placeholder="Y" value="2">
                                        <input type="number" id="normal-v-z" class="form-control" placeholder="Z" value="3">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateNormal()">Calculate Normal Vector</button>
                                
                                <div class="result-box">
                                    <p>Normal Vector: (<span id="normal-result-x">0</span>, <span id="normal-result-y">0</span>, <span id="normal-result-z">0</span>)</p>
                                    <p>Unit Normal Vector: (<span id="unit-normal-result-x">0</span>, <span id="unit-normal-result-y">0</span>, <span id="unit-normal-result-z">0</span>)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="normal-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the two vectors defining the plane (blue and green) and the normal vector (red) perpendicular to both.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Resultant Velocity Tab -->
            <div class="tab-pane fade" id="velocity" role="tabpanel">
                <h2>Resultant Velocity</h2>
                <p>Resultant velocity is the vector sum of individual velocity vectors.</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Velocity Vector 1</label>
                                    <div class="vector-input">
                                        <input type="number" id="velocity1-x" class="form-control" placeholder="X" value="3">
                                        <input type="number" id="velocity1-y" class="form-control" placeholder="Y" value="2">
                                        <input type="number" id="velocity1-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Velocity Vector 2</label>
                                    <div class="vector-input">
                                        <input type="number" id="velocity2-x" class="form-control" placeholder="X" value="1">
                                        <input type="number" id="velocity2-y" class="form-control" placeholder="Y" value="4">
                                        <input type="number" id="velocity2-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Velocity Vector 3 (optional)</label>
                                    <div class="vector-input">
                                        <input type="number" id="velocity3-x" class="form-control" placeholder="X" value="0">
                                        <input type="number" id="velocity3-y" class="form-control" placeholder="Y" value="0">
                                        <input type="number" id="velocity3-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateResultantVelocity()">Calculate Resultant</button>
                                
                                <div class="result-box">
                                    <p>Resultant Velocity: (<span id="resultant-velocity-x">0</span>, <span id="resultant-velocity-y">0</span>, <span id="resultant-velocity-z">0</span>)</p>
                                    <p>Magnitude: <span id="resultant-magnitude">0</span> m/s</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="velocity-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the individual velocity vectors and their resultant (thick black arrow).</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Vector Equation of a Line Tab -->
            <div class="tab-pane fade" id="line" role="tabpanel">
                <h2>Vector Equation of a Line</h2>
                <p>A line can be defined as r = r₀ + tv, where r₀ is a point on the line and v is the direction vector.</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Point on Line (r₀)</label>
                                    <div class="vector-input">
                                        <input type="number" id="line-point-x" class="form-control" placeholder="X" value="1">
                                        <input type="number" id="line-point-y" class="form-control" placeholder="Y" value="2">
                                        <input type="number" id="line-point-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Direction Vector (v)</label>
                                    <div class="vector-input">
                                        <input type="number" id="line-direction-x" class="form-control" placeholder="X" value="2">
                                        <input type="number" id="line-direction-y" class="form-control" placeholder="Y" value="1">
                                        <input type="number" id="line-direction-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Parameter t value</label>
                                    <input type="number" id="line-t" class="form-control" value="1" step="0.1">
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateLinePoint()">Calculate Point on Line</button>
                                
                                <div class="result-box">
                                    <p>Vector Equation: r = (1, 2, 0) + t(2, 1, 0)</p>
                                    <p>Point at t=<span id="t-value">1</span>: (<span id="line-result-x">0</span>, <span id="line-result-y">0</span>, <span id="line-result-z">0</span>)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="line-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the line defined by the point and direction vector. The red point shows the position for the current t value.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Linear Velocity Tab -->
            <div class="tab-pane fade" id="linear" role="tabpanel">
                <h2>Linear Velocity</h2>
                <p>Linear velocity v = ω × r, where ω is angular velocity and r is position vector.</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Angular Velocity (ω) in rad/s</label>
                                    <div class="vector-input">
                                        <input type="number" id="angular-x" class="form-control" placeholder="X" value="0">
                                        <input type="number" id="angular-y" class="form-control" placeholder="Y" value="0">
                                        <input type="number" id="angular-z" class="form-control" placeholder="Z" value="2">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Position Vector (r)</label>
                                    <div class="vector-input">
                                        <input type="number" id="linear-position-x" class="form-control" placeholder="X" value="3">
                                        <input type="number" id="linear-position-y" class="form-control" placeholder="Y" value="0">
                                        <input type="number" id="linear-position-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateLinearVelocity()">Calculate Linear Velocity</button>
                                
                                <div class="result-box">
                                    <p>Linear Velocity: (<span id="linear-velocity-x">0</span>, <span id="linear-velocity-y">0</span>, <span id="linear-velocity-z">0</span>) m/s</p>
                                    <p>Magnitude: <span id="linear-magnitude">0</span> m/s</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="linear-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the position vector (green), angular velocity (blue), and resulting linear velocity (red).</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Vector Normalization Tab -->
            <div class="tab-pane fade" id="normalization" role="tabpanel">
                <h2>Vector Normalization</h2>
                <p>Normalization converts a vector to a unit vector: û = u / |u|</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Vector to Normalize</label>
                                    <div class="vector-input">
                                        <input type="number" id="normalize-x" class="form-control" placeholder="X" value="3">
                                        <input type="number" id="normalize-y" class="form-control" placeholder="Y" value="4">
                                        <input type="number" id="normalize-z" class="form-control" placeholder="Z" value="0">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateNormalization()">Normalize Vector</button>
                                
                                <div class="result-box">
                                    <p>Original Vector: (<span id="original-vector-x">0</span>, <span id="original-vector-y">0</span>, <span id="original-vector-z">0</span>)</p>
                                    <p>Magnitude: <span id="original-magnitude">0</span></p>
                                    <p>Unit Vector: (<span id="unit-vector-x">0</span>, <span id="unit-vector-y">0</span>, <span id="unit-vector-z">0</span>)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="normalization-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the original vector (blue) and its normalized version (red) which has the same direction but length 1.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Equilibrium of Forces Tab -->
            <div class="tab-pane fade" id="equilibrium" role="tabpanel">
                <h2>Equilibrium of Forces</h2>
                <p>For equilibrium, the vector sum of all forces must be zero: ΣF = 0</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div id="force-inputs">
                                    <div class="force-input-group">
                                        <label class="form-label">Force 1</label>
                                        <div class="vector-input">
                                            <input type="number" class="form-control force-x" placeholder="X" value="3">
                                            <input type="number" class="form-control force-y" placeholder="Y" value="4">
                                            <input type="number" class="form-control force-z" placeholder="Z" value="0">
                                        </div>
                                    </div>
                                    <div class="force-input-group">
                                        <label class="form-label">Force 2</label>
                                        <div class="vector-input">
                                            <input type="number" class="form-control force-x" placeholder="X" value="-2">
                                            <input type="number" class="form-control force-y" placeholder="Y" value="1">
                                            <input type="number" class="form-control force-z" placeholder="Z" value="0">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <button class="btn btn-secondary" onclick="addForce()">Add Another Force</button>
                                    <button class="btn btn-secondary" onclick="removeForce()">Remove Force</button>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateEquilibrium()">Check Equilibrium</button>
                                
                                <div class="result-box">
                                    <p>Resultant Force: (<span id="resultant-force-x">0</span>, <span id="resultant-force-y">0</span>, <span id="resultant-force-z">0</span>)</p>
                                    <p>Magnitude: <span id="resultant-force-magnitude">0</span> N</p>
                                    <p>System is in Equilibrium: <span id="equilibrium-status">No</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="equilibrium-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows all force vectors and their resultant. If the resultant is zero (origin point), the system is in equilibrium.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Distance to a Plane Tab -->
            <div class="tab-pane fade" id="distance" role="tabpanel">
                <h2>Distance to a Plane</h2>
                <p>The distance from a point to a plane defined by ax+by+cz+d=0 is |ax₀+by₀+cz₀+d|/√(a²+b²+c²)</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Input Parameters</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Plane Equation: ax + by + cz + d = 0</label>
                                    <div class="vector-input">
                                        <input type="number" id="plane-a" class="form-control" placeholder="a" value="1">
                                        <input type="number" id="plane-b" class="form-control" placeholder="b" value="1">
                                        <input type="number" id="plane-c" class="form-control" placeholder="c" value="1">
                                        <input type="number" id="plane-d" class="form-control" placeholder="d" value="-5">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Point (x₀, y₀, z₀)</label>
                                    <div class="vector-input">
                                        <input type="number" id="point-x" class="form-control" placeholder="x" value="1">
                                        <input type="number" id="point-y" class="form-control" placeholder="y" value="2">
                                        <input type="number" id="point-z" class="form-control" placeholder="z" value="3">
                                    </div>
                                </div>
                                
                                <button class="btn btn-calculate" onclick="calculateDistanceToPlane()">Calculate Distance</button>
                                
                                <div class="result-box">
                                    <p>Distance: <span id="distance-result">0</span> units</p>
                                    <p>Plane Equation: <span id="plane-equation">0</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Visualization</div>
                            <div class="card-body">
                                <div class="canvas-container">
                                    <div id="distance-canvas"></div>
                                </div>
                                <p class="text-muted">The visualization shows the plane and the point. The distance is shown as a perpendicular line from the point to the plane.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="text-center">
            <p>Vector Physics Applications Visualization &copy; 2023</p>
        </footer>
    </div>

    <script>
        // Work Done Calculation
        function calculateWork() {
            const forceX = parseFloat(document.getElementById('force-x').value) || 0;
            const forceY = parseFloat(document.getElementById('force-y').value) || 0;
            const forceZ = parseFloat(document.getElementById('force-z').value) || 0;
            
            const displacementX = parseFloat(document.getElementById('displacement-x').value) || 0;
            const displacementY = parseFloat(document.getElementById('displacement-y').value) || 0;
            const displacementZ = parseFloat(document.getElementById('displacement-z').value) || 0;
            
            // Dot product calculation
            const work = forceX * displacementX + forceY * displacementY + forceZ * displacementZ;
            
            document.getElementById('work-result').textContent = work.toFixed(2);
        }
        
        // Area of Parallelogram Calculation
        function calculateArea() {
            const aX = parseFloat(document.getElementById('vector-a-x').value) || 0;
            const aY = parseFloat(document.getElementById('vector-a-y').value) || 0;
            const aZ = parseFloat(document.getElementById('vector-a-z').value) || 0;
            
            const bX = parseFloat(document.getElementById('vector-b-x').value) || 0;
            const bY = parseFloat(document.getElementById('vector-b-y').value) || 0;
            const bZ = parseFloat(document.getElementById('vector-b-z').value) || 0;
            
            // Cross product magnitude calculation
            const crossX = aY * bZ - aZ * bY;
            const crossY = aZ * bX - aX * bZ;
            const crossZ = aX * bY - aY * bX;
            
            const area = Math.sqrt(crossX * crossX + crossY * crossY + crossZ * crossZ);
            
            document.getElementById('area-result').textContent = area.toFixed(2);
        }
        
        // Torque Calculation
        function calculateTorque() {
            const positionX = parseFloat(document.getElementById('position-x').value) || 0;
            const positionY = parseFloat(document.getElementById('position-y').value) || 0;
            const positionZ = parseFloat(document.getElementById('position-z').value) || 0;
            
            const forceX = parseFloat(document.getElementById('torque-force-x').value) || 0;
            const forceY = parseFloat(document.getElementById('torque-force-y').value) || 0;
            const forceZ = parseFloat(document.getElementById('torque-force-z').value) || 0;
            
            // Cross product calculation
            const torqueX = positionY * forceZ - positionZ * forceY;
            const torqueY = positionZ * forceX - positionX * forceZ;
            const torqueZ = positionX * forceY - positionY * forceX;
            
            const torqueMagnitude = Math.sqrt(torqueX * torqueX + torqueY * torqueY + torqueZ * torqueZ);
            
            document.getElementById('torque-result').textContent = torqueMagnitude.toFixed(2);
            document.getElementById('torque-vector-x').textContent = torqueX.toFixed(2);
            document.getElementById('torque-vector-y').textContent = torqueY.toFixed(2);
            document.getElementById('torque-vector-z').textContent = torqueZ.toFixed(2);
        }
        
        // Normal Vector Calculation
        function calculateNormal() {
            const uX = parseFloat(document.getElementById('normal-u-x').value) || 0;
            const uY = parseFloat(document.getElementById('normal-u-y').value) || 0;
            const uZ = parseFloat(document.getElementById('normal-u-z').value) || 0;
            
            const vX = parseFloat(document.getElementById('normal-v-x').value) || 0;
            const vY = parseFloat(document.getElementById('normal-v-y').value) || 0;
            const vZ = parseFloat(document.getElementById('normal-v-z').value) || 0;
            
            // Cross product calculation
            const normalX = uY * vZ - uZ * vY;
            const normalY = uZ * vX - uX * vZ;
            const normalZ = uX * vY - uY * vX;
            
            const magnitude = Math.sqrt(normalX * normalX + normalY * normalY + normalZ * normalZ);
            
            const unitNormalX = magnitude !== 0 ? normalX / magnitude : 0;
            const unitNormalY = magnitude !== 0 ? normalY / magnitude : 0;
            const unitNormalZ = magnitude !== 0 ? normalZ / magnitude : 0;
            
            document.getElementById('normal-result-x').textContent = normalX.toFixed(2);
            document.getElementById('normal-result-y').textContent = normalY.toFixed(2);
            document.getElementById('normal-result-z').textContent = normalZ.toFixed(2);
            
            document.getElementById('unit-normal-result-x').textContent = unitNormalX.toFixed(2);
            document.getElementById('unit-normal-result-y').textContent = unitNormalY.toFixed(2);
            document.getElementById('unit-normal-result-z').textContent = unitNormalZ.toFixed(2);
        }
        
        // Resultant Velocity Calculation
        function calculateResultantVelocity() {
            const v1X = parseFloat(document.getElementById('velocity1-x').value) || 0;
            const v1Y = parseFloat(document.getElementById('velocity1-y').value) || 0;
            const v1Z = parseFloat(document.getElementById('velocity1-z').value) || 0;
            
            const v2X = parseFloat(document.getElementById('velocity2-x').value) || 0;
            const v2Y = parseFloat(document.getElementById('velocity2-y').value) || 0;
            const v2Z = parseFloat(document.getElementById('velocity2-z').value) || 0;
            
            const v3X = parseFloat(document.getElementById('velocity3-x').value) || 0;
            const v3Y = parseFloat(document.getElementById('velocity3-y').value) || 0;
            const v3Z = parseFloat(document.getElementById('velocity3-z').value) || 0;
            
            // Vector addition
            const resultantX = v1X + v2X + v3X;
            const resultantY = v1Y + v2Y + v3Y;
            const resultantZ = v1Z + v2Z + v3Z;
            
            const magnitude = Math.sqrt(resultantX * resultantX + resultantY * resultantY + resultantZ * resultantZ);
            
            document.getElementById('resultant-velocity-x').textContent = resultantX.toFixed(2);
            document.getElementById('resultant-velocity-y').textContent = resultantY.toFixed(2);
            document.getElementById('resultant-velocity-z').textContent = resultantZ.toFixed(2);
            document.getElementById('resultant-magnitude').textContent = magnitude.toFixed(2);
        }
        
        // Vector Equation of a Line Calculation
        function calculateLinePoint() {
            const pointX = parseFloat(document.getElementById('line-point-x').value) || 0;
            const pointY = parseFloat(document.getElementById('line-point-y').value) || 0;
            const pointZ = parseFloat(document.getElementById('line-point-z').value) || 0;
            
            const directionX = parseFloat(document.getElementById('line-direction-x').value) || 0;
            const directionY = parseFloat(document.getElementById('line-direction-y').value) || 0;
            const directionZ = parseFloat(document.getElementById('line-direction-z').value) || 0;
            
            const t = parseFloat(document.getElementById('line-t').value) || 0;
            
            // Calculate point on line: r = r0 + t*v
            const resultX = pointX + t * directionX;
            const resultY = pointY + t * directionY;
            const resultZ = pointZ + t * directionZ;
            
            document.getElementById('t-value').textContent = t;
            document.getElementById('line-result-x').textContent = resultX.toFixed(2);
            document.getElementById('line-result-y').textContent = resultY.toFixed(2);
            document.getElementById('line-result-z').textContent = resultZ.toFixed(2);
        }
        
        // Linear Velocity Calculation
        function calculateLinearVelocity() {
            const angularX = parseFloat(document.getElementById('angular-x').value) || 0;
            const angularY = parseFloat(document.getElementById('angular-y').value) || 0;
            const angularZ = parseFloat(document.getElementById('angular-z').value) || 0;
            
            const positionX = parseFloat(document.getElementById('linear-position-x').value) || 0;
            const positionY = parseFloat(document.getElementById('linear-position-y').value) || 0;
            const positionZ = parseFloat(document.getElementById('linear-position-z').value) || 0;
            
            // Cross product: v = ω × r
            const linearX = angularY * positionZ - angularZ * positionY;
            const linearY = angularZ * positionX - angularX * positionZ;
            const linearZ = angularX * positionY - angularY * positionX;
            
            const magnitude = Math.sqrt(linearX * linearX + linearY * linearY + linearZ * linearZ);
            
            document.getElementById('linear-velocity-x').textContent = linearX.toFixed(2);
            document.getElementById('linear-velocity-y').textContent = linearY.toFixed(2);
            document.getElementById('linear-velocity-z').textContent = linearZ.toFixed(2);
            document.getElementById('linear-magnitude').textContent = magnitude.toFixed(2);
        }
        
        // Vector Normalization Calculation
        function calculateNormalization() {
            const x = parseFloat(document.getElementById('normalize-x').value) || 0;
            const y = parseFloat(document.getElementById('normalize-y').value) || 0;
            const z = parseFloat(document.getElementById('normalize-z').value) || 0;
            
            const magnitude = Math.sqrt(x*x + y*y + z*z);
            
            const unitX = magnitude !== 0 ? x / magnitude : 0;
            const unitY = magnitude !== 0 ? y / magnitude : 0;
            const unitZ = magnitude !== 0 ? z / magnitude : 0;
            
            document.getElementById('original-vector-x').textContent = x.toFixed(2);
            document.getElementById('original-vector-y').textContent = y.toFixed(2);
            document.getElementById('original-vector-z').textContent = z.toFixed(2);
            document.getElementById('original-magnitude').textContent = magnitude.toFixed(2);
            document.getElementById('unit-vector-x').textContent = unitX.toFixed(2);
            document.getElementById('unit-vector-y').textContent = unitY.toFixed(2);
            document.getElementById('unit-vector-z').textContent = unitZ.toFixed(2);
        }
        
        // Equilibrium of Forces Calculation
        function calculateEquilibrium() {
            const forceInputs = document.querySelectorAll('.force-input-group');
            let resultantX = 0, resultantY = 0, resultantZ = 0;
            
            forceInputs.forEach((inputGroup, index) => {
                const x = parseFloat(inputGroup.querySelector('.force-x').value) || 0;
                const y = parseFloat(inputGroup.querySelector('.force-y').value) || 0;
                const z = parseFloat(inputGroup.querySelector('.force-z').value) || 0;
                
                resultantX += x;
                resultantY += y;
                resultantZ += z;
            });
            
            const magnitude = Math.sqrt(resultantX*resultantX + resultantY*resultantY + resultantZ*resultantZ);
            const isEquilibrium = magnitude < 0.01; // Small threshold for floating point precision
            
            document.getElementById('resultant-force-x').textContent = resultantX.toFixed(2);
            document.getElementById('resultant-force-y').textContent = resultantY.toFixed(2);
            document.getElementById('resultant-force-z').textContent = resultantZ.toFixed(2);
            document.getElementById('resultant-force-magnitude').textContent = magnitude.toFixed(2);
            document.getElementById('equilibrium-status').textContent = isEquilibrium ? "Yes" : "No";
            document.getElementById('equilibrium-status').style.color = isEquilibrium ? "green" : "red";
        }
        
        // Distance to Plane Calculation
        function calculateDistanceToPlane() {
            const a = parseFloat(document.getElementById('plane-a').value) || 0;
            const b = parseFloat(document.getElementById('plane-b').value) || 0;
            const c = parseFloat(document.getElementById('plane-c').value) || 0;
            const d = parseFloat(document.getElementById('plane-d').value) || 0;
            
            const x0 = parseFloat(document.getElementById('point-x').value) || 0;
            const y0 = parseFloat(document.getElementById('point-y').value) || 0;
            const z0 = parseFloat(document.getElementById('point-z').value) || 0;
            
            const numerator = Math.abs(a*x0 + b*y0 + c*z0 + d);
            const denominator = Math.sqrt(a*a + b*b + c*c);
            const distance = denominator !== 0 ? numerator / denominator : 0;
            
            document.getElementById('distance-result').textContent = distance.toFixed(2);
            document.getElementById('plane-equation').textContent = `${a}x + ${b}y + ${c}z + ${d} = 0`;
        }
        
        // Force input management for equilibrium
        function addForce() {
            const forceInputs = document.getElementById('force-inputs');
            const forceCount = forceInputs.children.length + 1;
            
            const newForce = document.createElement('div');
            newForce.className = 'force-input-group';
            newForce.innerHTML = `
                <label class="form-label">Force ${forceCount}</label>
                <div class="vector-input">
                    <input type="number" class="form-control force-x" placeholder="X" value="0">
                    <input type="number" class="form-control force-y" placeholder="Y" value="0">
                    <input type="number" class="form-control force-z" placeholder="Z" value="0">
                </div>
            `;
            
            forceInputs.appendChild(newForce);
        }
        
        function removeForce() {
            const forceInputs = document.getElementById('force-inputs');
            if (forceInputs.children.length > 1) {
                forceInputs.removeChild(forceInputs.lastChild);
            }
        }

        // P5.js Visualizations
        let workSketch, areaSketch, torqueSketch, normalSketch, velocitySketch, 
            lineSketch, linearSketch, normalizationSketch, equilibriumSketch, distanceSketch;

        // Work Visualization
        function initWorkVisualization() {
            workSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('work-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const forceX = parseFloat(document.getElementById('force-x').value) || 0;
                    const forceY = parseFloat(document.getElementById('force-y').value) || 0;
                    const displacementX = parseFloat(document.getElementById('displacement-x').value) || 0;
                    const displacementY = parseFloat(document.getElementById('displacement-y').value) || 0;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 20;
                    
                    // Draw displacement vector (blue)
                    p.stroke(52, 152, 219);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + displacementX * scale, centerY - displacementY * scale);
                    
                    // Draw force vector (red)
                    p.stroke(231, 76, 60);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + forceX * scale, centerY - forceY * scale);
                    
                    // Draw projection
                    const dotProduct = forceX * displacementX + forceY * displacementY;
                    const displacementMagnitudeSq = displacementX * displacementX + displacementY * displacementY;
                    const projectionFactor = displacementMagnitudeSq !== 0 ? dotProduct / displacementMagnitudeSq : 0;
                    
                    p.stroke(231, 76, 60);
                    p.strokeWeight(2);
                    p.drawingContext.setLineDash([5, 5]);
                    p.line(centerX, centerY, 
                           centerX + displacementX * projectionFactor * scale, 
                           centerY - displacementY * projectionFactor * scale);
                    p.drawingContext.setLineDash([]);
                    
                    // Labels
                    p.fill(52, 152, 219);
                    p.noStroke();
                    p.text('Displacement', centerX + displacementX * scale / 2, centerY - displacementY * scale / 2 - 10);
                    p.fill(231, 76, 60);
                    p.text('Force', centerX + forceX * scale / 2, centerY - forceY * scale / 2 + 15);
                };
            });
        }

        // Area Visualization
        function initAreaVisualization() {
            areaSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('area-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const aX = parseFloat(document.getElementById('vector-a-x').value) || 0;
                    const aY = parseFloat(document.getElementById('vector-a-y').value) || 0;
                    const bX = parseFloat(document.getElementById('vector-b-x').value) || 0;
                    const bY = parseFloat(document.getElementById('vector-b-y').value) || 0;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 20;
                    
                    // Draw vector A
                    p.stroke(52, 152, 219);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + aX * scale, centerY - aY * scale);
                    
                    // Draw vector B
                    p.stroke(231, 76, 60);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + bX * scale, centerY - bY * scale);
                    
                    // Draw parallelogram
                    p.stroke(44, 62, 80);
                    p.strokeWeight(1);
                    p.fill(52, 152, 219, 100);
                    p.quad(centerX, centerY,
                           centerX + aX * scale, centerY - aY * scale,
                           centerX + aX * scale + bX * scale, centerY - aY * scale - bY * scale,
                           centerX + bX * scale, centerY - bY * scale);
                    
                    // Labels
                    p.fill(52, 152, 219);
                    p.noStroke();
                    p.text('Vector A', centerX + aX * scale / 2, centerY - aY * scale / 2 - 10);
                    p.fill(231, 76, 60);
                    p.text('Vector B', centerX + bX * scale / 2, centerY - bY * scale / 2 + 15);
                };
            });
        }

        // Torque Visualization
        function initTorqueVisualization() {
            torqueSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('torque-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const positionX = parseFloat(document.getElementById('position-x').value) || 0;
                    const positionY = parseFloat(document.getElementById('position-y').value) || 0;
                    const forceX = parseFloat(document.getElementById('torque-force-x').value) || 0;
                    const forceY = parseFloat(document.getElementById('torque-force-y').value) || 0;
                    
                    // Calculate torque vector (perpendicular to the plane)
                    const torqueZ = positionX * forceY - positionY * forceX;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 20;
                    
                    // Draw position vector (green)
                    p.stroke(46, 204, 113);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + positionX * scale, centerY - positionY * scale);
                    
                    // Draw force vector (red)
                    p.stroke(231, 76, 60);
                    p.strokeWeight(3);
                    p.line(centerX + positionX * scale, centerY - positionY * scale, 
                           centerX + positionX * scale + forceX * scale, centerY - positionY * scale - forceY * scale);
                    
                    // Draw torque vector (purple) - perpendicular to the plane
                    p.stroke(155, 89, 182);
                    p.strokeWeight(3);
                    // Representing the torque as coming out of the plane (z-direction)
                    p.line(centerX, centerY, centerX, centerY - torqueZ * scale / 10);
                    
                    // Labels
                    p.fill(46, 204, 113);
                    p.noStroke();
                    p.text('Position', centerX + positionX * scale / 2, centerY - positionY * scale / 2 - 10);
                    p.fill(231, 76, 60);
                    p.text('Force', centerX + positionX * scale + forceX * scale / 2, 
                           centerY - positionY * scale - forceY * scale / 2 + 15);
                    p.fill(155, 89, 182);
                    p.text('Torque', centerX, centerY - torqueZ * scale / 20 - 10);
                };
            });
        }

        // Normal Vector Visualization
        function initNormalVisualization() {
            normalSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('normal-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const uX = parseFloat(document.getElementById('normal-u-x').value) || 0;
                    const uY = parseFloat(document.getElementById('normal-u-y').value) || 0;
                    const uZ = parseFloat(document.getElementById('normal-u-z').value) || 0;
                    
                    const vX = parseFloat(document.getElementById('normal-v-x').value) || 0;
                    const vY = parseFloat(document.getElementById('normal-v-y').value) || 0;
                    const vZ = parseFloat(document.getElementById('normal-v-z').value) || 0;
                    
                    // Calculate normal vector
                    const normalX = uY * vZ - uZ * vY;
                    const normalY = uZ * vX - uX * vZ;
                    const normalZ = uX * vY - uY * vX;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 15;
                    
                    // Draw vector U (blue)
                    p.stroke(52, 152, 219);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + uX * scale, centerY - uY * scale);
                    
                    // Draw vector V (green)
                    p.stroke(46, 204, 113);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + vX * scale, centerY - vY * scale);
                    
                    // Draw normal vector (red)
                    p.stroke(231, 76, 60);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + normalX * scale, centerY - normalY * scale);
                    
                    // Labels
                    p.fill(52, 152, 219);
                    p.noStroke();
                    p.text('Vector U', centerX + uX * scale / 2, centerY - uY * scale / 2 - 10);
                    p.fill(46, 204, 113);
                    p.text('Vector V', centerX + vX * scale / 2, centerY - vY * scale / 2 + 15);
                    p.fill(231, 76, 60);
                    p.text('Normal', centerX + normalX * scale / 2, centerY - normalY * scale / 2 - 10);
                };
            });
        }

        // Resultant Velocity Visualization
        function initVelocityVisualization() {
            velocitySketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('velocity-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const v1X = parseFloat(document.getElementById('velocity1-x').value) || 0;
                    const v1Y = parseFloat(document.getElementById('velocity1-y').value) || 0;
                    const v2X = parseFloat(document.getElementById('velocity2-x').value) || 0;
                    const v2Y = parseFloat(document.getElementById('velocity2-y').value) || 0;
                    const v3X = parseFloat(document.getElementById('velocity3-x').value) || 0;
                    const v3Y = parseFloat(document.getElementById('velocity3-y').value) || 0;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 15;
                    
                    // Draw individual velocity vectors
                    p.stroke(52, 152, 219);
                    p.strokeWeight(2);
                    p.line(centerX, centerY, centerX + v1X * scale, centerY - v1Y * scale);
                    
                    p.stroke(46, 204, 113);
                    p.strokeWeight(2);
                    p.line(centerX, centerY, centerX + v2X * scale, centerY - v2Y * scale);
                    
                    p.stroke(155, 89, 182);
                    p.strokeWeight(2);
                    p.line(centerX, centerY, centerX + v3X * scale, centerY - v3Y * scale);
                    
                    // Calculate and draw resultant
                    const resultantX = v1X + v2X + v3X;
                    const resultantY = v1Y + v2Y + v3Y;
                    
                    p.stroke(0);
                    p.strokeWeight(4);
                    p.line(centerX, centerY, centerX + resultantX * scale, centerY - resultantY * scale);
                    
                    // Labels
                    p.fill(52, 152, 219);
                    p.noStroke();
                    p.text('V1', centerX + v1X * scale / 2, centerY - v1Y * scale / 2 - 10);
                    p.fill(46, 204, 113);
                    p.text('V2', centerX + v2X * scale / 2, centerY - v2Y * scale / 2 + 15);
                    p.fill(155, 89, 182);
                    p.text('V3', centerX + v3X * scale / 2, centerY - v3Y * scale / 2 - 10);
                    p.fill(0);
                    p.text('Resultant', centerX + resultantX * scale / 2, centerY - resultantY * scale / 2 + 15);
                };
            });
        }

        // Vector Equation of a Line Visualization
        function initLineVisualization() {
            lineSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('line-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const pointX = parseFloat(document.getElementById('line-point-x').value) || 0;
                    const pointY = parseFloat(document.getElementById('line-point-y').value) || 0;
                    const directionX = parseFloat(document.getElementById('line-direction-x').value) || 0;
                    const directionY = parseFloat(document.getElementById('line-direction-y').value) || 0;
                    const t = parseFloat(document.getElementById('line-t').value) || 0;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 20;
                    
                    // Calculate point on line
                    const resultX = pointX + t * directionX;
                    const resultY = pointY + t * directionY;
                    
                    // Draw the line
                    p.stroke(52, 152, 219);
                    p.strokeWeight(1);
                    p.drawingContext.setLineDash([5, 5]);
                    p.line(centerX - directionX * 10 * scale, centerY + directionY * 10 * scale,
                           centerX + directionX * 10 * scale, centerY - directionY * 10 * scale);
                    p.drawingContext.setLineDash([]);
                    
                    // Draw direction vector
                    p.stroke(231, 76, 60);
                    p.strokeWeight(3);
                    p.line(centerX + pointX * scale, centerY - pointY * scale,
                           centerX + pointX * scale + directionX * scale, centerY - pointY * scale - directionY * scale);
                    
                    // Draw point on line
                    p.fill(231, 76, 60);
                    p.noStroke();
                    p.ellipse(centerX + resultX * scale, centerY - resultY * scale, 10, 10);
                    
                    // Draw reference point
                    p.fill(52, 152, 219);
                    p.ellipse(centerX + pointX * scale, centerY - pointY * scale, 8, 8);
                    
                    // Labels
                    p.fill(52, 152, 219);
                    p.text('r₀', centerX + pointX * scale + 10, centerY - pointY * scale);
                    p.fill(231, 76, 60);
                    p.text('v', centerX + pointX * scale + directionX * scale / 2, 
                           centerY - pointY * scale - directionY * scale / 2 - 10);
                    p.text(`t=${t}`, centerX + resultX * scale + 10, centerY - resultY * scale);
                };
            });
        }

        // Linear Velocity Visualization
        function initLinearVisualization() {
            linearSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('linear-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const angularZ = parseFloat(document.getElementById('angular-z').value) || 0;
                    const positionX = parseFloat(document.getElementById('linear-position-x').value) || 0;
                    const positionY = parseFloat(document.getElementById('linear-position-y').value) || 0;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 20;
                    
                    // Draw position vector (green)
                    p.stroke(46, 204, 113);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + positionX * scale, centerY - positionY * scale);
                    
                    // Draw angular velocity (blue) - represented as circular arrow
                    p.stroke(52, 152, 219);
                    p.strokeWeight(2);
                    p.noFill();
                    p.ellipse(centerX, centerY, 50, 50);
                    
                    // Draw direction of rotation
                    const arrowSize = 10;
                    if (angularZ > 0) {
                        // Counterclockwise
                        p.triangle(centerX + 25, centerY, centerX + 25 - arrowSize, centerY - arrowSize/2, 
                                  centerX + 25 - arrowSize, centerY + arrowSize/2);
                    } else if (angularZ < 0) {
                        // Clockwise
                        p.triangle(centerX + 25, centerY, centerX + 25 - arrowSize, centerY + arrowSize/2, 
                                  centerX + 25 - arrowSize, centerY - arrowSize/2);
                    }
                    
                    // Calculate and draw linear velocity (red)
                    const linearX = -angularZ * positionY;
                    const linearY = angularZ * positionX;
                    
                    p.stroke(231, 76, 60);
                    p.strokeWeight(3);
                    p.line(centerX + positionX * scale, centerY - positionY * scale,
                           centerX + positionX * scale + linearX * scale, centerY - positionY * scale - linearY * scale);
                    
                    // Labels
                    p.fill(46, 204, 113);
                    p.noStroke();
                    p.text('r', centerX + positionX * scale / 2, centerY - positionY * scale / 2 - 10);
                    p.fill(52, 152, 219);
                    p.text('ω', centerX + 30, centerY - 30);
                    p.fill(231, 76, 60);
                    p.text('v', centerX + positionX * scale + linearX * scale / 2, 
                           centerY - positionY * scale - linearY * scale / 2 + 15);
                };
            });
        }

        // Vector Normalization Visualization
        function initNormalizationVisualization() {
            normalizationSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('normalization-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const x = parseFloat(document.getElementById('normalize-x').value) || 0;
                    const y = parseFloat(document.getElementById('normalize-y').value) || 0;
                    
                    const magnitude = Math.sqrt(x*x + y*y);
                    const unitX = magnitude !== 0 ? x / magnitude : 0;
                    const unitY = magnitude !== 0 ? y / magnitude : 0;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 30;
                    
                    // Draw original vector (blue)
                    p.stroke(52, 152, 219);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + x * scale, centerY - y * scale);
                    
                    // Draw unit vector (red)
                    p.stroke(231, 76, 60);
                    p.strokeWeight(3);
                    p.line(centerX, centerY, centerX + unitX * scale, centerY - unitY * scale);
                    
                    // Draw unit circle
                    p.stroke(200);
                    p.strokeWeight(1);
                    p.noFill();
                    p.ellipse(centerX, centerY, scale * 2, scale * 2);
                    
                    // Labels
                    p.fill(52, 152, 219);
                    p.noStroke();
                    p.text(`Original (|v| = ${magnitude.toFixed(2)})`, centerX + x * scale / 2, centerY - y * scale / 2 - 10);
                    p.fill(231, 76, 60);
                    p.text('Unit Vector (|û| = 1)', centerX + unitX * scale / 2, centerY - unitY * scale / 2 + 15);
                };
            });
        }

        // Equilibrium of Forces Visualization
        function initEquilibriumVisualization() {
            equilibriumSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('equilibrium-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const forceInputs = document.querySelectorAll('.force-input-group');
                    let forces = [];
                    
                    forceInputs.forEach((inputGroup, index) => {
                        const x = parseFloat(inputGroup.querySelector('.force-x').value) || 0;
                        const y = parseFloat(inputGroup.querySelector('.force-y').value) || 0;
                        forces.push({x, y});
                    });
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 15;
                    
                    // Draw each force vector
                    const colors = [p.color(52, 152, 219), p.color(46, 204, 113), 
                                   p.color(155, 89, 182), p.color(241, 196, 15),
                                   p.color(230, 126, 34)];
                    
                    let currentX = 0, currentY = 0;
                    
                    forces.forEach((force, index) => {
                        p.stroke(colors[index % colors.length]);
                        p.strokeWeight(2);
                        p.line(centerX + currentX * scale, centerY - currentY * scale,
                               centerX + (currentX + force.x) * scale, centerY - (currentY + force.y) * scale);
                        
                        currentX += force.x;
                        currentY += force.y;
                    });
                    
                    // Draw resultant vector
                    p.stroke(0);
                    p.strokeWeight(4);
                    p.line(centerX, centerY, centerX + currentX * scale, centerY - currentY * scale);
                    
                    // Draw origin point
                    p.fill(231, 76, 60);
                    p.noStroke();
                    p.ellipse(centerX, centerY, 8, 8);
                    
                    // Label
                    p.fill(0);
                    p.text(`Resultant`, centerX + currentX * scale / 2, centerY - currentY * scale / 2 - 10);
                };
            });
        }

        // Distance to Plane Visualization
        function initDistanceVisualization() {
            distanceSketch = new p5(function(p) {
                p.setup = function() {
                    const canvas = p.createCanvas(400, 300);
                    canvas.parent('distance-canvas');
                };
                
                p.draw = function() {
                    p.background(240);
                    
                    const a = parseFloat(document.getElementById('plane-a').value) || 0;
                    const b = parseFloat(document.getElementById('plane-b').value) || 0;
                    const c = parseFloat(document.getElementById('plane-c').value) || 0;
                    const d = parseFloat(document.getElementById('plane-d').value) || 0;
                    
                    const x0 = parseFloat(document.getElementById('point-x').value) || 0;
                    const y0 = parseFloat(document.getElementById('point-y').value) || 0;
                    
                    const centerX = p.width / 2;
                    const centerY = p.height / 2;
                    const scale = 20;
                    
                    // For simplicity, we'll visualize in 2D (assuming z=0)
                    // The plane equation becomes: ax + by + d = 0
                    
                    // Find two points on the plane
                    let point1, point2;
                    
                    if (b !== 0) {
                        // When x=0, y = -d/b
                        point1 = {x: 0, y: -d/b};
                        // When x=5, y = -(a*5 + d)/b
                        point2 = {x: 5, y: -(a*5 + d)/b};
                    } else if (a !== 0) {
                        // When y=0, x = -d/a
                        point1 = {x: -d/a, y: 0};
                        // When y=5, x = -(b*5 + d)/a
                        point2 = {x: -(b*5 + d)/a, y: 5};
                    } else {
                        // Both a and b are zero, use default points
                        point1 = {x: -2, y: 0};
                        point2 = {x: 2, y: 0};
                    }
                    
                    // Draw the plane (line in 2D)
                    p.stroke(52, 152, 219);
                    p.strokeWeight(2);
                    p.line(centerX + point1.x * scale, centerY - point1.y * scale,
                           centerX + point2.x * scale, centerY - point2.y * scale);
                    
                    // Draw the point
                    p.fill(231, 76, 60);
                    p.noStroke();
                    p.ellipse(centerX + x0 * scale, centerY - y0 * scale, 10, 10);
                    
                    // Calculate and draw the perpendicular distance
                    const numerator = Math.abs(a*x0 + b*y0 + d);
                    const denominator = Math.sqrt(a*a + b*b);
                    const distance = denominator !== 0 ? numerator / denominator : 0;
                    
                    // Find the closest point on the plane to the given point
                    const t = -(a*x0 + b*y0 + d) / (a*a + b*b);
                    const closestX = x0 + a * t;
                    const closestY = y0 + b * t;
                    
                    // Draw the perpendicular line
                    p.stroke(231, 76, 60);
                    p.strokeWeight(2);
                    p.drawingContext.setLineDash([5, 5]);
                    p.line(centerX + x0 * scale, centerY - y0 * scale,
                           centerX + closestX * scale, centerY - closestY * scale);
                    p.drawingContext.setLineDash([]);
                    
                    // Labels
                    p.fill(52, 152, 219);
                    p.text('Plane', centerX + (point1.x + point2.x)/2 * scale, 
                           centerY - (point1.y + point2.y)/2 * scale - 10);
                    p.fill(231, 76, 60);
                    p.text(`Point (${x0}, ${y0})`, centerX + x0 * scale + 10, centerY - y0 * scale);
                    p.text(`Distance: ${distance.toFixed(2)}`, centerX, centerY + 130);
                };
            });
        }

        // Initialize all visualizations when the page loads
        window.onload = function() {
            // Initialize all calculations
            calculateWork();
            calculateArea();
            calculateTorque();
            calculateNormal();
            calculateResultantVelocity();
            calculateLinePoint();
            calculateLinearVelocity();
            calculateNormalization();
            calculateEquilibrium();
            calculateDistanceToPlane();
            
            // Initialize all visualizations
            initWorkVisualization();
            initAreaVisualization();
            initTorqueVisualization();
            initNormalVisualization();
            initVelocityVisualization();
            initLineVisualization();
            initLinearVisualization();
            initNormalizationVisualization();
            initEquilibriumVisualization();
            initDistanceVisualization();
        };
        
        // Update visualizations when tab is shown
        document.querySelectorAll('button[data-bs-toggle="tab"]').forEach(tab => {
            tab.addEventListener('shown.bs.tab', function(event) {
                const tabId = event.target.id;
                
                if (tabId === 'work-tab') {
                    calculateWork();
                } else if (tabId === 'area-tab') {
                    calculateArea();
                } else if (tabId === 'torque-tab') {
                    calculateTorque();
                } else if (tabId === 'normal-tab') {
                    calculateNormal();
                } else if (tabId === 'velocity-tab') {
                    calculateResultantVelocity();
                } else if (tabId === 'line-tab') {
                    calculateLinePoint();
                } else if (tabId === 'linear-tab') {
                    calculateLinearVelocity();
                } else if (tabId === 'normalization-tab') {
                    calculateNormalization();
                } else if (tabId === 'equilibrium-tab') {
                    calculateEquilibrium();
                } else if (tabId === 'distance-tab') {
                    calculateDistanceToPlane();
                }
            });
        });
               // AI Features Implementation
        

// Problem Generation
function generateProblem(difficulty) {
    const problemDiv = document.getElementById('generated-problem');
    problemDiv.innerHTML = '<p class="ai-thinking">Generating a ' + difficulty + ' physics problem...</p>';
    
    // Simulate AI thinking
    setTimeout(() => {
        let problem = '';
        let solution = '';
        let calculation = '';
        
        // Array of problems for each difficulty
        const problems = {
            easy: [
                {
                    problem: 'A force of 8N is applied at an angle of 30° to the horizontal. Calculate the work done when the object moves 5m horizontally.',
                    solution: 'Work = Force × Displacement × cos(θ) = 8N × 5m × cos(30°) = 34.64 Joules',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Identify the formula</strong><br>
                            Work (W) = Force (F) × Displacement (d) × cos(θ)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Plug in values</strong><br>
                            W = 8N × 5m × cos(30°)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Calculate cos(30°)</strong><br>
                            cos(30°) = √3/2 ≈ 0.8660
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Multiply values</strong><br>
                            W = 8 × 5 × 0.8660 = 40 × 0.8660 = 34.64 J
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Work done = <strong>34.64 Joules</strong>
                        </div>
                    `
                },
                {
                    problem: 'Calculate the dot product of vectors A(3, 2) and B(4, 1).',
                    solution: 'A·B = (3×4) + (2×1) = 12 + 2 = 14',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Dot product formula for 2D vectors</strong><br>
                            A·B = A<sub>x</sub>B<sub>x</sub> + A<sub>y</sub>B<sub>y</sub>
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Plug in values</strong><br>
                            A·B = (3×4) + (2×1)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Multiply components</strong><br>
                            = 12 + 2
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Sum the results</strong><br>
                            = 14
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Dot product = <strong>14</strong>
                        </div>
                    `
                },
                {
                    problem: 'Find the magnitude of vector V(6, 8).',
                    solution: '|V| = √(6² + 8²) = √(36 + 64) = √100 = 10',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Magnitude formula</strong><br>
                            |V| = √(V<sub>x</sub>² + V<sub>y</sub>²)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Square each component</strong><br>
                            6² = 36, 8² = 64
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Sum the squares</strong><br>
                            36 + 64 = 100
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Take square root</strong><br>
                            √100 = 10
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Magnitude = <strong>10</strong>
                        </div>
                    `
                },
                {
                    problem: 'Add vectors P(2, 3) and Q(1, 4).',
                    solution: 'P + Q = (2+1, 3+4) = (3, 7)',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Vector addition formula</strong><br>
                            P + Q = (P<sub>x</sub>+Q<sub>x</sub>, P<sub>y</sub>+Q<sub>y</sub>)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Add x-components</strong><br>
                            2 + 1 = 3
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Add y-components</strong><br>
                            3 + 4 = 7
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Combine results</strong><br>
                            (3, 7)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Resultant vector = <strong>(3, 7)</strong>
                        </div>
                    `
                },
                {
                    problem: 'Subtract vector B(5, 2) from vector A(8, 6).',
                    solution: 'A - B = (8-5, 6-2) = (3, 4)',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Vector subtraction formula</strong><br>
                            A - B = (A<sub>x</sub>-B<sub>x</sub>, A<sub>y</sub>-B<sub>y</sub>)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Subtract x-components</strong><br>
                            8 - 5 = 3
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Subtract y-components</strong><br>
                            6 - 2 = 4
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Combine results</strong><br>
                            (3, 4)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Result = <strong>(3, 4)</strong>
                        </div>
                    `
                },
                {
                    problem: 'Calculate scalar multiplication: 3 × vector C(2, 5)',
                    solution: '3 × C = (3×2, 3×5) = (6, 15)',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Scalar multiplication formula</strong><br>
                            k × V = (k×V<sub>x</sub>, k×V<sub>y</sub>)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Multiply x-component</strong><br>
                            3 × 2 = 6
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Multiply y-component</strong><br>
                            3 × 5 = 15
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Combine results</strong><br>
                            (6, 15)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Scaled vector = <strong>(6, 15)</strong>
                        </div>
                    `
                }
            ],
            medium: [
                {
                    problem: 'Calculate the torque produced by a force of 12N applied at a point 0.5m from the pivot. The force is applied at an angle of 60° to the lever arm.',
                    solution: 'Torque = r × F × sin(θ) = 0.5m × 12N × sin(60°) = 5.196 N·m',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Torque formula</strong><br>
                            τ = r × F × sin(θ)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Plug in values</strong><br>
                            τ = 0.5m × 12N × sin(60°)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Calculate sin(60°)</strong><br>
                            sin(60°) = √3/2 ≈ 0.8660
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Multiply values</strong><br>
                            τ = 0.5 × 12 × 0.8660 = 6 × 0.8660 = 5.196 N·m
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Torque = <strong>5.196 N·m</strong>
                        </div>
                    `
                },
                {
                    problem: 'Find the cross product of vectors U(2, 3, 1) and V(4, -1, 3).',
                    solution: 'U×V = (3×3 - 1×-1, 1×4 - 2×3, 2×-1 - 3×4) = (9+1, 4-6, -2-12) = (10, -2, -14)',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Cross product formula</strong><br>
                            U×V = (U<sub>y</sub>V<sub>z</sub>-U<sub>z</sub>V<sub>y</sub>, U<sub>z</sub>V<sub>x</sub>-U<sub>x</sub>V<sub>z</sub>, U<sub>x</sub>V<sub>y</sub>-U<sub>y</sub>V<sub>x</sub>)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Calculate x-component</strong><br>
                            3×3 - 1×(-1) = 9 + 1 = 10
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Calculate y-component</strong><br>
                            1×4 - 2×3 = 4 - 6 = -2
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Calculate z-component</strong><br>
                            2×(-1) - 3×4 = -2 - 12 = -14
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Cross product = <strong>(10, -2, -14)</strong>
                        </div>
                    `
                },
                {
                    problem: 'Calculate the area of parallelogram formed by vectors A(3, 2) and B(1, 4).',
                    solution: 'Area = |A × B| = |3×4 - 2×1| = |12 - 2| = 10 square units',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Area formula for parallelogram</strong><br>
                            Area = |A × B| (magnitude of cross product)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Calculate cross product (2D)</strong><br>
                            A × B = A<sub>x</sub>B<sub>y</sub> - A<sub>y</sub>B<sub>x</sub>
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Plug in values</strong><br>
                            3×4 - 2×1 = 12 - 2 = 10
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Take absolute value</strong><br>
                            |10| = 10
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Area = <strong>10 square units</strong>
                        </div>
                    `
                },
                {
                    problem: 'Find the angle between vectors P(1, 2, 3) and Q(4, 5, 6).',
                    solution: 'P·Q = 32, |P| = √14 ≈ 3.74, |Q| = √77 ≈ 8.77, cosθ = 32/(3.74×8.77) ≈ 0.974, θ ≈ 13°',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Dot product</strong><br>
                            P·Q = 1×4 + 2×5 + 3×6 = 4 + 10 + 18 = 32
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Magnitude of P</strong><br>
                            |P| = √(1² + 2² + 3²) = √(1+4+9) = √14 ≈ 3.74
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Magnitude of Q</strong><br>
                            |Q| = √(4² + 5² + 6²) = √(16+25+36) = √77 ≈ 8.77
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Cosine formula</strong><br>
                            cosθ = (P·Q)/(|P||Q|) = 32/(3.74×8.77) ≈ 32/32.8 ≈ 0.9756
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Find angle</strong><br>
                            θ = cos⁻¹(0.9756) ≈ 12.7° ≈ 13°
                        </div>
                    `
                },
                {
                    problem: 'Calculate the projection of vector A(3, 4) onto vector B(1, 2).',
                    solution: 'proj<sub>B</sub>A = [(A·B)/(B·B)] × B = [11/5] × (1,2) = (2.2, 4.4)',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Dot product A·B</strong><br>
                            A·B = 3×1 + 4×2 = 3 + 8 = 11
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Dot product B·B</strong><br>
                            B·B = 1×1 + 2×2 = 1 + 4 = 5
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Scalar projection</strong><br>
                            (A·B)/(B·B) = 11/5 = 2.2
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Vector projection</strong><br>
                            2.2 × (1, 2) = (2.2, 4.4)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Projection = <strong>(2.2, 4.4)</strong>
                        </div>
                    `
                },
                {
                    problem: 'Find the unit vector in the direction of vector V(3, 4).',
                    solution: '|V| = 5, Unit vector = (3/5, 4/5) = (0.6, 0.8)',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Calculate magnitude</strong><br>
                            |V| = √(3² + 4²) = √(9+16) = √25 = 5
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Divide each component by magnitude</strong><br>
                            x-component: 3/5 = 0.6<br>
                            y-component: 4/5 = 0.8
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Combine results</strong><br>
                            (0.6, 0.8)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Verify magnitude</strong><br>
                            √(0.6² + 0.8²) = √(0.36+0.64) = √1 = 1 ✓
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Unit vector = <strong>(0.6, 0.8)</strong>
                        </div>
                    `
                }
            ],
            hard: [
                {
                    problem: 'A plane is defined by points A(1,0,0), B(0,2,0), and C(0,0,3). Find the distance from point P(2,3,4) to this plane.',
                    solution: 'Normal vector n = AB × AC = (6,3,2). Distance = |(P-A)·n|/|n| = 23/7 ≈ 3.29 units',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Find vectors AB and AC</strong><br>
                            AB = B - A = (-1, 2, 0)<br>
                            AC = C - A = (-1, 0, 3)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Calculate normal vector n = AB × AC</strong><br>
                            n = (2×3-0×0, 0×(-1)-(-1)×3, -1×0-2×(-1)) = (6, 3, 2)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Find vector AP</strong><br>
                            AP = P - A = (1, 3, 4)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Calculate dot product AP·n</strong><br>
                            AP·n = 1×6 + 3×3 + 4×2 = 6 + 9 + 8 = 23
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Calculate |n|</strong><br>
                            |n| = √(6²+3²+2²) = √(36+9+4) = √49 = 7
                        </div>
                        <div class="step-explanation">
                            <strong>Step 6: Distance formula</strong><br>
                            Distance = |AP·n|/|n| = 23/7 ≈ 3.29 units
                        </div>
                    `
                },
                {
                    problem: 'Find the equation of the plane passing through points A(1,2,3), B(4,5,6), and C(7,8,10).',
                    solution: 'Normal vector n = AB × AC = (-3,6,-3). Plane equation: -3(x-1) + 6(y-2) - 3(z-3) = 0 → -3x + 6y - 3z + 6 = 0',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Find vectors AB and AC</strong><br>
                            AB = B - A = (3, 3, 3)<br>
                            AC = C - A = (6, 6, 7)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Calculate normal vector n = AB × AC</strong><br>
                            n = (3×7-3×6, 3×6-3×7, 3×6-3×6) = (21-18, 18-21, 18-18) = (3, -3, 0)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Use point-normal form</strong><br>
                            n·(r - A) = 0 → 3(x-1) - 3(y-2) + 0(z-3) = 0
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Simplify equation</strong><br>
                            3x - 3 - 3y + 6 = 0 → 3x - 3y + 3 = 0
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final equation</strong><br>
                            <strong>3x - 3y + 3 = 0</strong> or <strong>x - y + 1 = 0</strong>
                        </div>
                    `
                },
                {
                    problem: 'Calculate the volume of parallelepiped formed by vectors A(1,0,2), B(2,1,3), and C(0,2,1).',
                    solution: 'Volume = |A·(B×C)| = |1×(1×1-3×2) - 0×(2×1-3×0) + 2×(2×2-1×0)| = |1×(-5) + 2×4| = |-5+8| = 3 cubic units',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Volume formula</strong><br>
                            Volume = |A·(B×C)| (absolute value of scalar triple product)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Calculate B×C</strong><br>
                            B×C = (1×1-3×2, 3×0-2×1, 2×2-1×0) = (1-6, 0-2, 4-0) = (-5, -2, 4)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Calculate A·(B×C)</strong><br>
                            A·(B×C) = 1×(-5) + 0×(-2) + 2×4 = -5 + 0 + 8 = 3
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Take absolute value</strong><br>
                            |3| = 3
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Volume = <strong>3 cubic units</strong>
                        </div>
                    `
                },
                {
                    problem: 'Find the line of intersection of planes: 2x + y - z = 3 and x - y + 2z = 1.',
                    solution: 'Direction vector d = n1 × n2 = (2,1,-1) × (1,-1,2) = (1,-5,-3). Point on line: solve system to get (1,1,0). Line: r = (1,1,0) + t(1,-5,-3)',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Find normal vectors</strong><br>
                            n1 = (2, 1, -1), n2 = (1, -1, 2)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Direction vector d = n1 × n2</strong><br>
                            d = (1×2-(-1)×(-1), (-1)×1-2×2, 2×(-1)-1×1) = (2-1, -1-4, -2-1) = (1, -5, -3)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Find point on both planes</strong><br>
                            Let z=0: 2x+y=3 and x-y=1 → solving gives x=1, y=0<br>
                            Point = (1, 0, 0)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Parametric equation</strong><br>
                            x = 1 + t, y = 0 - 5t, z = 0 - 3t
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Line: <strong>r = (1,0,0) + t(1,-5,-3)</strong>
                        </div>
                    `
                },
                {
                    problem: 'Calculate the moment of force F(3,4,5) applied at point P(1,2,3) about point Q(0,1,2).',
                    solution: 'Moment = PQ × F = (1,1,1) × (3,4,5) = (1×5-1×4, 1×3-1×5, 1×4-1×3) = (1,-2,1) N·m',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Find position vector PQ</strong><br>
                            PQ = P - Q = (1-0, 2-1, 3-2) = (1, 1, 1)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Moment formula</strong><br>
                            Moment = PQ × F
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Calculate cross product</strong><br>
                            PQ × F = (1×5-1×4, 1×3-1×5, 1×4-1×3) = (5-4, 3-5, 4-3) = (1, -2, 1)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Interpret result</strong><br>
                            Moment vector = (1, -2, 1) N·m
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Final answer</strong><br>
                            Moment = <strong>(1, -2, 1) N·m</strong>
                        </div>
                    `
                },
                {
                    problem: 'Find the shortest distance between skew lines: L1: r = (1,2,3) + t(1,1,1) and L2: r = (4,5,6) + s(2,-1,1).',
                    solution: 'Direction vectors: d1=(1,1,1), d2=(2,-1,1). Vector between points: PQ=(3,3,3). Distance = |PQ·(d1×d2)|/|d1×d2| = |18|/√36 = 18/6 = 3 units',
                    calculation: `
                        <div class="step-explanation">
                            <strong>Step 1: Find direction vectors</strong><br>
                            d1 = (1,1,1), d2 = (2,-1,1)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 2: Calculate d1 × d2</strong><br>
                            d1 × d2 = (1×1-1×(-1), 1×2-1×1, 1×(-1)-1×2) = (1+1, 2-1, -1-2) = (2, 1, -3)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 3: Find vector between points</strong><br>
                            PQ = (4-1, 5-2, 6-3) = (3, 3, 3)
                        </div>
                        <div class="step-explanation">
                            <strong>Step 4: Calculate |d1 × d2|</strong><br>
                            |d1 × d2| = √(2²+1²+(-3)²) = √(4+1+9) = √14
                        </div>
                        <div class="step-explanation">
                            <strong>Step 5: Calculate distance</strong><br>
                            Distance = |PQ·(d1×d2)|/|d1×d2| = |(3,3,3)·(2,1,-3)|/√14 = |6+3-9|/√14 = |0|/√14 = 0
                        </div>
                        <div class="step-explanation">
                            <strong>Note:</strong> The lines intersect, so shortest distance is 0
                        </div>
                    `
                }
            ]
        };

        // Select a random problem from the chosen difficulty
        const problemSet = problems[difficulty];
        const randomIndex = Math.floor(Math.random() * problemSet.length);
        const selectedProblem = problemSet[randomIndex];
        
        problem = selectedProblem.problem;
        solution = selectedProblem.solution;
        calculation = selectedProblem.calculation;
        
        problemDiv.innerHTML = `
            <h5>Generated Problem (${difficulty}):</h5>
            <p>${problem}</p>
            <h5>Solution:</h5>
            <p>${solution}</p>
            <div id="detailed-calculation" style="display:none;">
                <h5>Detailed Calculation:</h5>
                ${calculation}
            </div>
            <button class="ai-button" onclick="applyGeneratedProblem('${difficulty}', this)">Apply to Calculator</button>
            <button class="ai-button" onclick="showDetailedCalculation()" id="show-calculation-btn" style="display:none;">Show Detailed Calculation</button>
            <button class="ai-button" onclick="generateProblem('${difficulty}')">Generate Another ${difficulty} Problem</button>
        `;
    }, 1000);
}
       
function showDetailedCalculation() {
    const calcDiv = document.getElementById('detailed-calculation');
    const showBtn = document.getElementById('show-calculation-btn');
    
    if (calcDiv.style.display === 'none') {
        calcDiv.style.display = 'block';
        showBtn.textContent = 'Hide Detailed Calculation';
    } else {
        calcDiv.style.display = 'none';
        showBtn.textContent = 'Show Detailed Calculation';
    }
}

function applyGeneratedProblem(difficulty, button) {
    // Show the detailed calculation when applying
    const calcDiv = document.getElementById('detailed-calculation');
    const showBtn = document.getElementById('show-calculation-btn');
    
    calcDiv.style.display = 'block';
    showBtn.style.display = 'inline-block';
    showBtn.textContent = 'Hide Detailed Calculation';
    
    // In a real implementation, this would parse the problem and set the input values
    alert(`The ${difficulty} problem has been applied to the calculator. Detailed calculation is shown below.`);
}

// Enhanced problem generation with 5 additional problems covering all operations
function generateAdditionalProblem(problemType) {
    const problemDiv = document.getElementById('generated-problem');
    problemDiv.innerHTML = '<p class="ai-thinking">Generating a ' + problemType + ' problem...</p>';
    
    setTimeout(() => {
        let problem = '';
        let solution = '';
        let calculation = '';
        
        switch(problemType) {
            case 'dot-product':
                problem = 'Calculate the dot product of vectors A(3, 4, 2) and B(1, -2, 5).';
                solution = 'A·B = (3×1) + (4×-2) + (2×5) = 3 - 8 + 10 = 5';
                calculation = `
                    <div class="step-explanation">
                        <strong>Step 1: Dot product formula</strong><br>
                        A·B = A<sub>x</sub>B<sub>x</sub> + A<sub>y</sub>B<sub>y</sub> + A<sub>z</sub>B<sub>z</sub>
                    </div>
                    <div class="step-explanation">
                        <strong>Step 2: Plug in values</strong><br>
                        A·B = (3×1) + (4×-2) + (2×5)
                    </div>
                    <div class="step-explanation">
                        <strong>Step 3: Multiply components</strong><br>
                        = 3 + (-8) + 10
                    </div>
                    <div class="step-explanation">
                        <strong>Step 4: Sum the results</strong><br>
                        = 3 - 8 + 10 = 5
                    </div>
                    <div class="step-explanation">
                        <strong>Step 5: Final answer</strong><br>
                        Dot product = <strong>5</strong>
                    </div>
                `;
                break;
                
            case 'cross-product':
                problem = 'Find the cross product of vectors U(2, 3, 1) and V(4, -1, 3).';
                solution = 'U×V = (3×3 - 1×-1, 1×4 - 2×3, 2×-1 - 3×4) = (9 - (-1), 4 - 6, -2 - 12) = (10, -2, -14)';
                calculation = `
                    <div class="step-explanation">
                        <strong>Step 1: Cross product formula</strong><br>
                        U×V = (U<sub>y</sub>V<sub>z</sub> - U<sub>z</sub>V<sub>y</sub>, U<sub>z</sub>V<sub>x</sub> - U<sub>x</sub>V<sub>z</sub>, U<sub>x</sub>V<sub>y</sub> - U<sub>y</sub>V<sub>x</sub>)
                    </div>
                    <div class="step-explanation">
                        <strong>Step 2: Calculate x-component</strong><br>
                        U<sub>y</sub>V<sub>z</sub> - U<sub>z</sub>V<sub>y</sub> = 3×3 - 1×(-1) = 9 - (-1) = 10
                    </div>
                    <div class="step-explanation">
                        <strong>Step 3: Calculate y-component</strong><br>
                        U<sub>z</sub>V<sub>x</sub> - U<sub>x</sub>V<sub>z</sub> = 1×4 - 2×3 = 4 - 6 = -2
                    </div>
                    <div class="step-explanation">
                        <strong>Step 4: Calculate z-component</strong><br>
                        U<sub>x</sub>V<sub>y</sub> - U<sub>y</sub>V<sub>x</sub> = 2×(-1) - 3×4 = -2 - 12 = -14
                    </div>
                    <div class="step-explanation">
                        <strong>Step 5: Final answer</strong><br>
                        Cross product = <strong>(10, -2, -14)</strong>
                    </div>
                `;
                break;
                
            case 'vector-magnitude':
                problem = 'Calculate the magnitude of vector R(4, -3, 6).';
                solution = '|R| = √(4² + (-3)² + 6²) = √(16 + 9 + 36) = √61 ≈ 7.81';
                calculation = `
                    <div class="step-explanation">
                        <strong>Step 1: Magnitude formula</strong><br>
                        |R| = √(R<sub>x</sub>² + R<sub>y</sub>² + R<sub>z</sub>²)
                    </div>
                    <div class="step-explanation">
                        <strong>Step 2: Square each component</strong><br>
                        4² = 16, (-3)² = 9, 6² = 36
                    </div>
                    <div class="step-explanation">
                        <strong>Step 3: Sum the squares</strong><br>
                        16 + 9 + 36 = 61
                    </div>
                    <div class="step-explanation">
                        <strong>Step 4: Take square root</strong><br>
                        √61 ≈ 7.8102
                    </div>
                    <div class="step-explanation">
                        <strong>Step 5: Final answer</strong><br>
                        Magnitude = <strong>√61 ≈ 7.81</strong>
                    </div>
                `;
                break;
                
            case 'angle-between-vectors':
                problem = 'Find the angle between vectors P(1, 2, 3) and Q(4, 5, 6).';
                solution = 'P·Q = 1×4 + 2×5 + 3×6 = 32, |P| = √14 ≈ 3.74, |Q| = √77 ≈ 8.77, cosθ = 32/(3.74×8.77) ≈ 0.974, θ ≈ 13°';
                calculation = `
                    <div class="step-explanation">
                        <strong>Step 1: Dot product</strong><br>
                        P·Q = 1×4 + 2×5 + 3×6 = 4 + 10 + 18 = 32
                    </div>
                    <div class="step-explanation">
                        <strong>Step 2: Magnitude of P</strong><br>
                        |P| = √(1² + 2² + 3²) = √(1 + 4 + 9) = √14 ≈ 3.74
                    </div>
                    <div class="step-explanation">
                        <strong>Step 3: Magnitude of Q</strong><br>
                        |Q| = √(4² + 5² + 6²) = √(16 + 25 + 36) = √77 ≈ 8.77
                    </div>
                    <div class="step-explanation">
                        <strong>Step 4: Cosine formula</strong><br>
                        cosθ = (P·Q) / (|P| × |Q|) = 32 / (3.74 × 8.77) ≈ 32 / 32.8 ≈ 0.9756
                    </div>
                    <div class="step-explanation">
                        <strong>Step 5: Find angle</strong><br>
                        θ = cos⁻¹(0.9756) ≈ 12.7° ≈ 13°
                    </div>
                `;
                break;
                
            case 'vector-projection':
                problem = 'Find the projection of vector A(3, 4) onto vector B(1, 2).';
                solution = 'proj<sub>B</sub>A = [(A·B)/(B·B)] × B = [(3×1 + 4×2)/(1×1 + 2×2)] × (1,2) = [11/5] × (1,2) = (2.2, 4.4)';
                calculation = `
                    <div class="step-explanation">
                        <strong>Step 1: Dot product A·B</strong><br>
                        A·B = 3×1 + 4×2 = 3 + 8 = 11
                    </div>
                    <div class="step-explanation">
                        <strong>Step 2: Dot product B·B</strong><br>
                        B·B = 1×1 + 2×2 = 1 + 4 = 5
                    </div>
                    <div class="step-explanation">
                        <strong>Step 3: Scalar projection</strong><br>
                        scalar = (A·B) / (B·B) = 11 / 5 = 2.2
                    </div>
                    <div class="step-explanation">
                        <strong>Step 4: Vector projection</strong><br>
                        proj<sub>B</sub>A = scalar × B = 2.2 × (1, 2) = (2.2, 4.4)
                    </div>
                    <div class="step-explanation">
                        <strong>Step 5: Final answer</strong><br>
                        Projection = <strong>(2.2, 4.4)</strong>
                    </div>
                `;
                break;
        }
        
        problemDiv.innerHTML = `
            <h5>Generated Problem (${problemType.replace('-', ' ')}):</h5>
            <p>${problem}</p>
            <h5>Solution:</h5>
            <p>${solution}</p>
            <div id="detailed-calculation" style="display:none;">
                <h5>Detailed Calculation:</h5>
                ${calculation}
            </div>
            <button class="ai-button" onclick="applyGeneratedProblem('${problemType}', this)">Apply to Calculator</button>
            <button class="ai-button" onclick="showDetailedCalculation()" id="show-calculation-btn" style="display:none;">Show Detailed Calculation</button>
        `;
    }, 1000);
}


        // Natural Language Input
        function parseNaturalLanguage() {
            const input = document.getElementById('nl-input').value;
            const responseDiv = document.getElementById('nl-response');
            
            if (!input) {
                responseDiv.innerHTML = '<p class="text-danger">Please enter a problem description.</p>';
                return;
            }
            
            responseDiv.innerHTML = '<p class="ai-thinking">Parsing your problem: "' + input + '"...</p>';
            
            // Simulate AI processing
            setTimeout(() => {
                let parsedResult = '';
                let applied = false;
                
                // Simple keyword matching for demonstration
                if (input.toLowerCase().includes('work') && input.toLowerCase().includes('force')) {
                    parsedResult = `
                        <p>I've identified this as a work calculation problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Force: 5N at 30 degrees</li>
                            <li>Displacement: 10m</li>
                        </ul>
                        <p>Work = Force × Displacement × cos(θ) = 5N × 10m × cos(30°) = 43.3 Joules</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('torque')) {
                    parsedResult = `
                        <p>I've identified this as a torque calculation problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Force: 8N</li>
                            <li>Lever arm: 0.5m</li>
                            <li>Angle: 90 degrees</li>
                        </ul>
                        <p>Torque = r × F × sin(θ) = 0.5m × 8N × sin(90°) = 4 N·m</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('area') && input.toLowerCase().includes('parallelogram')) {
                    parsedResult = `
                        <p>I've identified this as an area of parallelogram problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Vector A: (3, 2)</li>
                            <li>Vector B: (1, 4)</li>
                        </ul>
                        <p>Area = |A × B| = |(3,2) × (1,4)| = |3×4 - 2×1| = |12 - 2| = 10 square units</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('normal') && input.toLowerCase().includes('vector')) {
                    parsedResult = `
                        <p>I've identified this as a normal vector calculation problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Vector U: (3, 1, 2)</li>
                            <li>Vector V: (1, 2, 3)</li>
                        </ul>
                        <p>Normal = U × V = (3,1,2) × (1,2,3) = (1×3-2×2, 2×1-3×3, 3×2-1×1) = (-1, -7, 5)</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('resultant') && input.toLowerCase().includes('velocity')) {
                    parsedResult = `
                        <p>I've identified this as a resultant velocity problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Velocity 1: (3, 2) m/s</li>
                            <li>Velocity 2: (1, 4) m/s</li>
                        </ul>
                        <p>Resultant = V1 + V2 = (3+1, 2+4) = (4, 6) m/s</p>
                        <p>Magnitude = √(4² + 6²) = √(16+36) = √52 ≈ 7.21 m/s</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('line') && input.toLowerCase().includes('vector')) {
                    parsedResult = `
                        <p>I've identified this as a vector equation of a line problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Point on line: (1, 2)</li>
                            <li>Direction vector: (2, 1)</li>
                            <li>Parameter t: 1</li>
                        </ul>
                        <p>Point on line = r₀ + t×v = (1,2) + 1×(2,1) = (3, 3)</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('linear') && input.toLowerCase().includes('velocity')) {
                    parsedResult = `
                        <p>I've identified this as a linear velocity problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Angular velocity: (0, 0, 2) rad/s</li>
                            <li>Position vector: (3, 0, 0) m</li>
                        </ul>
                        <p>Linear velocity = ω × r = (0,0,2) × (3,0,0) = (0, 6, 0) m/s</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('normalization') || input.toLowerCase().includes('unit vector')) {
                    parsedResult = `
                        <p>I've identified this as a vector normalization problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Vector: (3, 4)</li>
                        </ul>
                        <p>Magnitude = √(3² + 4²) = √(9+16) = √25 = 5</p>
                        <p>Unit vector = (3/5, 4/5) = (0.6, 0.8)</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('equilibrium') && input.toLowerCase().includes('force')) {
                    parsedResult = `
                        <p>I've identified this as an equilibrium of forces problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Force 1: (3, 4) N</li>
                            <li>Force 2: (-2, 1) N</li>
                        </ul>
                        <p>Resultant = (3-2, 4+1) = (1, 5) N</p>
                        <p>Magnitude = √(1² + 5²) = √26 ≈ 5.1 N</p>
                        <p>System is NOT in equilibrium (resultant ≠ 0)</p>
                    `;
                    applied = true;
                } else if (input.toLowerCase().includes('distance') && input.toLowerCase().includes('plane')) {
                    parsedResult = `
                        <p>I've identified this as a distance to plane problem.</p>
                        <p>Detected parameters:</p>
                        <ul>
                            <li>Plane: x + y + z - 5 = 0</li>
                            <li>Point: (1, 2, 3)</li>
                        </ul>
                        <p>Distance = |1×1 + 1×2 + 1×3 - 5| / √(1²+1²+1²) = |1+2+3-5|/√3 = |1|/√3 ≈ 0.577 units</p>
                    `;
                    applied = true;
                } else {
                    parsedResult = `
                        <p>I understand you're describing a physics problem. While I can't parse all details yet, 
                        I recommend using the specific calculators above for accurate results.</p>
                        <p>Try phrases like:</p>
                        <ul>
                            <li>"Calculate work done by a 5N force over 10m at 30 degrees"</li>
                            <li>"Find the torque from a 12N force applied 0.5m from pivot"</li>
                            <li>"What's the area of parallelogram with vectors (3,2) and (1,4)"</li>
                            <li>"Find the normal vector to plane with vectors (3,1,2) and (1,2,3)"</li>
                            <li>"Calculate resultant velocity of (3,2) and (1,4) m/s"</li>
                        </ul>
                    `;
                }
                
                responseDiv.innerHTML = parsedResult;
                
                if (applied) {
                    responseDiv.innerHTML += '<button class="ai-button" onclick="applyParsedProblem()">Apply to Calculator</button>';
                }
            }, 1500);
        }
        
        function applyParsedProblem() {
            alert('The parsed problem has been applied to the appropriate calculator.');
            // In a real implementation, this would set the input values based on the parsed problem
        }
          // Simulate AI processing
    setTimeout(() => {
        let parsedResult = '';
        let applied = false;
        let detailedCalc = '';
        
        // Simple keyword matching for demonstration
        if (input.toLowerCase().includes('work') && input.toLowerCase().includes('force')) {
            detailedCalc = `
                <div class="step-explanation">
                    <strong>Step 1: Identify parameters</strong><br>
                    Force = 5N, Displacement = 10m, Angle = 30°
                </div>
                <div class="step-explanation">
                    <strong>Step 2: Work formula</strong><br>
                    W = F × d × cos(θ)
                </div>
                <div class="step-explanation">
                    <strong>Step 3: Calculate cos(30°)</strong><br>
                    cos(30°) = √3/2 ≈ 0.8660
                </div>
                <div class="step-explanation">
                    <strong>Step 4: Multiply values</strong><br>
                    W = 5 × 10 × 0.8660 = 50 × 0.8660 = 43.3 J
                </div>
            `;
            parsedResult = `
                <p>I've identified this as a work calculation problem.</p>
                <p>Detected parameters:</p>
                <ul>
                    <li>Force: 5N at 30 degrees</li>
                    <li>Displacement: 10m</li>
                </ul>
                <p>Work = Force × Displacement × cos(θ) = 5N × 10m × cos(30°) = 43.3 Joules</p>
                <div id="nl-detailed-calc" style="display:none;">
                    <h6>Detailed Calculation:</h6>
                    ${detailedCalc}
                </div>
            `;
            applied = true;
        }
        // ... (keep the rest of your existing parsing logic, adding similar detailedCalc sections for each case)
        
        responseDiv.innerHTML = parsedResult;
        
        if (applied) {
            responseDiv.innerHTML += `
                <button class="ai-button" onclick="applyParsedProblem()">Apply to Calculator</button>
                <button class="ai-button" onclick="toggleNLCalculation()">Show Detailed Calculation</button>
            `;
        }
    }, 1500);

function toggleNLCalculation() {
    const calcDiv = document.getElementById('nl-detailed-calc');
    if (calcDiv) {
        if (calcDiv.style.display === 'none') {
            calcDiv.style.display = 'block';
        } else {
            calcDiv.style.display = 'none';
        }
    }
}

function applyParsedProblem() {
    alert('The parsed problem has been applied to the appropriate calculator.');
    // Show detailed calculation
    const calcDiv = document.getElementById('nl-detailed-calc');
    if (calcDiv) {
        calcDiv.style.display = 'block';
    }
}
  
        // Step-by-Step Explanations
        function explainCurrentCalculation() {
            const explanationDiv = document.getElementById('step-explanation');
            explanationDiv.innerHTML = '<p class="ai-thinking">Analyzing the current calculation...</p>';
            
            // Determine which tab is active
            const activeTab = document.querySelector('.nav-tabs .nav-link.active').id;
            
            setTimeout(() => {
                let explanation = '';
                
                switch(activeTab) {
                    case 'work-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Work Calculation:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the formula</strong><br>
                                Work (W) is defined as the dot product of force (F) and displacement (d) vectors: W = F · d
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Expand the dot product</strong><br>
                                The dot product can be calculated as: W = F<sub>x</sub>d<sub>x</sub> + F<sub>y</sub>d<sub>y</sub> + F<sub>z</sub>d<sub>z</sub>
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Alternative formula using magnitudes and angle</strong><br>
                                W = |F| × |d| × cos(θ), where θ is the angle between the vectors
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Physical interpretation</strong><br>
                                Work is only done by the component of force in the direction of displacement.
                                This is why we use cos(θ) - it gives us that component.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Units</strong><br>
                                Force is in Newtons (N), displacement in meters (m), so work is in Newton-meters (N·m) or Joules (J).
                            </div>
                        `;
                        break;
                    case 'area-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Area Calculation:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the formula</strong><br>
                                The area of a parallelogram formed by vectors a and b is the magnitude of their cross product: A = |a × b|
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Calculate the cross product</strong><br>
                                a × b = (a<sub>y</sub>b<sub>z</sub> - a<sub>z</sub>b<sub>y</sub>, a<sub>z</sub>b<sub>x</sub> - a<sub>x</sub>b<sub>z</sub>, a<sub>x</sub>b<sub>y</sub> - a<sub>y</sub>b<sub>x</sub>)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Find the magnitude</strong><br>
                                |a × b| = √[(a<sub>y</sub>b<sub>z</sub> - a<sub>z</sub>b<sub>y</sub>)² + (a<sub>z</sub>b<sub>x</sub> - a<sub>x</sub>b<sub>z</sub>)² + (a<sub>x</sub>b<sub>y</sub> - a<sub>y</sub>b<sub>x</sub>)²]
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Geometric interpretation</strong><br>
                                The cross product gives a vector perpendicular to both a and b, with magnitude equal to the area of the parallelogram.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Special case for 2D vectors</strong><br>
                                For 2D vectors (z=0), the area simplifies to |a<sub>x</sub>b<sub>y</sub> - a<sub>y</sub>b<sub>x</sub>|
                            </div>
                        `;
                        break;
                    case 'torque-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Torque Calculation:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the formula</strong><br>
                                Torque (τ) is the cross product of position vector (r) and force vector (F): τ = r × F
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Calculate the cross product</strong><br>
                                τ = r × F = (r<sub>y</sub>F<sub>z</sub> - r<sub>z</sub>F<sub>y</sub>, r<sub>z</sub>F<sub>x</sub> - r<sub>x</sub>F<sub>z</sub>, r<sub>x</sub>F<sub>y</sub> - r<sub>y</sub>F<sub>x</sub>)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Magnitude formula</strong><br>
                                |τ| = |r| × |F| × sin(θ), where θ is the angle between r and F
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Physical interpretation</strong><br>
                                Torque measures the rotational effect of a force. Only the component of force perpendicular to the lever arm (r) produces torque.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Right-hand rule</strong><br>
                                The direction of torque follows the right-hand rule: point fingers in direction of r, curl toward F, thumb shows torque direction.
                            </div>
                        `;
                        break;
                    case 'normal-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Normal Vector Calculation:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the concept</strong><br>
                                A normal vector is perpendicular to a surface. For a plane defined by two vectors, the normal is their cross product.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Calculate the cross product</strong><br>
                                n = u × v = (u<sub>y</sub>v<sub>z</sub> - u<sub>z</sub>v<sub>y</sub>, u<sub>z</sub>v<sub>x</sub> - u<sub>x</sub>v<sub>z</sub>, u<sub>x</sub>v<sub>y</sub> - u<sub>y</sub>v<sub>x</sub>)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Unit normal vector</strong><br>
                                To get a unit normal vector, divide the normal vector by its magnitude: û = n / |n|
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Geometric interpretation</strong><br>
                                The normal vector defines the orientation of the plane. Its direction indicates which side of the plane is "facing outward".
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Applications</strong><br>
                                Normal vectors are used in computer graphics for lighting calculations, in physics for surface interactions, and in engineering for stress analysis.
                            </div>
                        `;
                        break;
                    case 'velocity-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Resultant Velocity Calculation:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the concept</strong><br>
                                Resultant velocity is the vector sum of individual velocity vectors. It represents the net effect of all velocities.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Vector addition</strong><br>
                                v<sub>resultant</sub> = v<sub>1</sub> + v<sub>2</sub> + ... = (v<sub>1x</sub>+v<sub>2x</sub>+..., v<sub>1y</sub>+v<sub>2y</sub>+..., v<sub>1z</sub>+v<sub>2z</sub>+...)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Calculate magnitude</strong><br>
                                |v<sub>resultant</sub>| = √(v<sub>x</sub>² + v<sub>y</sub>² + v<sub>z</sub>²)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Physical interpretation</strong><br>
                                The resultant velocity gives the actual speed and direction of motion when multiple velocities act simultaneously.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Example application</strong><br>
                                When a boat moves across a river with current, the resultant velocity is the combination of the boat's engine power and the water current.
                            </div>
                        `;
                        break;
                    case 'line-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Vector Equation of a Line:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the formula</strong><br>
                                A line can be defined as r = r₀ + tv, where r₀ is a point on the line and v is the direction vector.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Parameter t</strong><br>
                                The parameter t can be any real number. As t varies, we get different points on the line.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Calculate a point on the line</strong><br>
                                For a specific t value: r = (r₀<sub>x</sub> + tv<sub>x</sub>, r₀<sub>y</sub> + tv<sub>y</sub>, r₀<sub>z</sub> + tv<sub>z</sub>)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Geometric interpretation</strong><br>
                                The vector equation represents all points on a straight line through r₀ in the direction of v.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Applications</strong><br>
                                This representation is useful in computer graphics, physics (ray tracing), and engineering (path planning).
                            </div>
                        `;
                        break;
                    case 'linear-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Linear Velocity Calculation:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the formula</strong><br>
                                Linear velocity v = ω × r, where ω is angular velocity and r is position vector.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Calculate the cross product</strong><br>
                                v = ω × r = (ω<sub>y</sub>r<sub>z</sub> - ω<sub>z</sub>r<sub>y</sub>, ω<sub>z</sub>r<sub>x</sub> - ω<sub>x</sub>r<sub>z</sub>, ω<sub>x</sub>r<sub>y</sub> - ω<sub>y</sub>r<sub>x</sub>)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Magnitude formula</strong><br>
                                |v| = |ω| × |r| × sin(θ), where θ is the angle between ω and r
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Physical interpretation</strong><br>
                                This formula gives the linear velocity of a point in a rotating system. The velocity is perpendicular to both the rotation axis and position vector.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Right-hand rule</strong><br>
                                The direction follows the right-hand rule: point fingers in direction of ω, curl toward r, thumb shows velocity direction.
                            </div>
                        `;
                        break;
                    case 'normalization-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Vector Normalization:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the concept</strong><br>
                                Normalization converts a vector to a unit vector: û = u / |u|
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Calculate magnitude</strong><br>
                                |u| = √(u<sub>x</sub>² + u<sub>y</sub>² + u<sub>z</sub>²)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Divide by magnitude</strong><br>
                                û = (u<sub>x</sub>/|u|, u<sub>y</sub>/|u|, u<sub>z</sub>/|u|)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Properties of unit vectors</strong><br>
                                Unit vectors have magnitude 1 and point in the same direction as the original vector.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Applications</strong><br>
                                Unit vectors are used to represent directions without magnitude, in coordinate systems, and for normalizing other vectors in calculations.
                            </div>
                        `;
                        break;
                    case 'equilibrium-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Equilibrium of Forces:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the condition</strong><br>
                                For equilibrium, the vector sum of all forces must be zero: ΣF = 0
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Calculate resultant force</strong><br>
                                F<sub>resultant</sub> = F<sub>1</sub> + F<sub>2</sub> + ... = (F<sub>1x</sub>+F<sub>2x</sub>+..., F<sub>1y</sub>+F<sub>2y</sub>+..., F<sub>1z</sub>+F<sub>2z</sub>+...)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Check equilibrium condition</strong><br>
                                If F<sub>resultant</sub> = (0, 0, 0), the system is in equilibrium.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Physical interpretation</strong><br>
                                In equilibrium, there is no net force acting on the object, so it remains at rest or moves with constant velocity.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Applications</strong><br>
                                Equilibrium analysis is crucial in structural engineering, statics, and any system where balanced forces are important.
                            </div>
                        `;
                        break;
                    case 'distance-tab':
                        explanation = `
                            <h5>Step-by-Step Explanation for Distance to a Plane Calculation:</h5>
                            <div class="step-explanation">
                                <strong>Step 1: Understand the formula</strong><br>
                                Distance = |ax₀ + by₀ + cz₀ + d| / √(a² + b² + c²)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 2: Plane equation</strong><br>
                                The plane is defined by ax + by + cz + d = 0, where (a, b, c) is the normal vector.
                            </div>
                            <div class="step-explanation">
                                <strong>Step 3: Calculate numerator</strong><br>
                                Numerator = |a×x₀ + b×y₀ + c×z₀ + d|
                            </div>
                            <div class="step-explanation">
                                <strong>Step 4: Calculate denominator</strong><br>
                                Denominator = √(a² + b² + c²) (magnitude of normal vector)
                            </div>
                            <div class="step-explanation">
                                <strong>Step 5: Geometric interpretation</strong><br>
                                This formula gives the shortest (perpendicular) distance from a point to a plane.
                            </div>
                        `;
                        break;
                    default:
                        explanation = '<p>Select a specific calculation tab to get detailed explanations for that concept.</p>';
                }
                
                explanationDiv.innerHTML = explanation;
            }, 1000);
        }
// Quiz Variables
// Quiz Variables
let currentQuiz = [];
let currentQuestionIndex = 0;
let userAnswers = [];
let quizScore = 0;

// Enhanced Quiz Question Database with 15+ problems per topic
const quizQuestions = {
    easy: [
        // Work Topic (15 questions)
        {
            question: "What is the dot product of vectors (3, 2) and (1, 4)?",
            options: ["11", "14", "10", "12"],
            correctAnswer: 0,
            explanation: "The dot product is calculated as (3×1) + (2×4) = 3 + 8 = 11.",
            topic: "work"
        },
        {
            question: "If a force of 5N is applied at 30° to move an object 10m, what is the work done?",
            options: ["25 J", "43.3 J", "50 J", "35 J"],
            correctAnswer: 1,
            explanation: "Work = Force × Displacement × cos(θ) = 5 × 10 × cos(30°) = 50 × 0.866 = 43.3 J.",
            topic: "work"
        },
        {
            question: "Calculate work done by force (2, 3) N over displacement (4, 1) m.",
            options: ["11 J", "12 J", "13 J", "14 J"],
            correctAnswer: 0,
            explanation: "Work = F·d = (2×4) + (3×1) = 8 + 3 = 11 J.",
            topic: "work"
        },
        {
            question: "A 10N force acts at 60° to displacement of 5m. Work done is?",
            options: ["25 J", "43.3 J", "50 J", "35 J"],
            correctAnswer: 0,
            explanation: "Work = 10 × 5 × cos(60°) = 50 × 0.5 = 25 J.",
            topic: "work"
        },
        {
            question: "Find work when F=(4,1) and d=(3,2).",
            options: ["14 J", "15 J", "16 J", "17 J"],
            correctAnswer: 0,
            explanation: "Work = (4×3) + (1×2) = 12 + 2 = 14 J.",
            topic: "work"
        },
        {
            question: "Work done by perpendicular force and displacement is?",
            options: ["Zero", "Maximum", "Minimum", "Infinite"],
            correctAnswer: 0,
            explanation: "When θ=90°, cos(90°)=0, so work done is zero.",
            topic: "work"
        },
        {
            question: "If F·d = 0, what is the angle between vectors?",
            options: ["90°", "0°", "45°", "180°"],
            correctAnswer: 0,
            explanation: "F·d = |F||d|cosθ = 0 ⇒ cosθ = 0 ⇒ θ = 90°.",
            topic: "work"
        },
        {
            question: "Calculate work: F=(5,0), d=(0,4)",
            options: ["0 J", "20 J", "15 J", "10 J"],
            correctAnswer: 0,
            explanation: "Work = (5×0) + (0×4) = 0 J (vectors are perpendicular).",
            topic: "work"
        },
        {
            question: "Maximum work occurs when angle between F and d is?",
            options: ["0°", "90°", "45°", "180°"],
            correctAnswer: 0,
            explanation: "Maximum work when cosθ=1 ⇒ θ=0°.",
            topic: "work"
        },
        {
            question: "Work is negative when angle is?",
            options: ["Greater than 90°", "Less than 90°", "Exactly 90°", "0°"],
            correctAnswer: 0,
            explanation: "Negative work when cosθ < 0 ⇒ θ > 90°.",
            topic: "work"
        },
        {
            question: "Find work: F=(3,4), d=(2,1)",
            options: ["10 J", "11 J", "12 J", "13 J"],
            correctAnswer: 0,
            explanation: "Work = (3×2) + (4×1) = 6 + 4 = 10 J.",
            topic: "work"
        },
        {
            question: "If |F|=8N, |d|=6m, θ=60°, work done is?",
            options: ["24 J", "36 J", "48 J", "60 J"],
            correctAnswer: 0,
            explanation: "Work = 8 × 6 × cos(60°) = 48 × 0.5 = 24 J.",
            topic: "work"
        },
        {
            question: "Work done by F=(1,2,3) over d=(4,5,6) is?",
            options: ["32 J", "28 J", "36 J", "40 J"],
            correctAnswer: 0,
            explanation: "Work = (1×4)+(2×5)+(3×6)=4+10+18=32 J.",
            topic: "work"
        },
        {
            question: "When work is maximum, cosθ equals?",
            options: ["1", "0", "-1", "0.5"],
            correctAnswer: 0,
            explanation: "Maximum work when cosθ=1.",
            topic: "work"
        },
        {
            question: "Work-energy theorem relates work to?",
            options: ["Kinetic energy", "Potential energy", "Thermal energy", "Chemical energy"],
            correctAnswer: 0,
            explanation: "Work-energy theorem: Work done = Change in kinetic energy.",
            topic: "work"
        },

        // Area Topic (15 questions)
        {
            question: "What is the area of the parallelogram formed by vectors (3, 2) and (1, 4)?",
            options: ["10", "12", "14", "16"],
            correctAnswer: 0,
            explanation: "Area = |3×4 - 2×1| = |12 - 2| = 10.",
            topic: "area"
        },
        {
            question: "Area of parallelogram with vectors (4,1) and (2,3) is?",
            options: ["10", "11", "12", "13"],
            correctAnswer: 0,
            explanation: "Area = |4×3 - 1×2| = |12 - 2| = 10.",
            topic: "area"
        },
        {
            question: "Find area with vectors (5,2) and (1,3).",
            options: ["13", "14", "15", "16"],
            correctAnswer: 0,
            explanation: "Area = |5×3 - 2×1| = |15 - 2| = 13.",
            topic: "area"
        },
        {
            question: "Area using cross product magnitude represents?",
            options: ["Parallelogram area", "Triangle area", "Circle area", "Rectangle area"],
            correctAnswer: 0,
            explanation: "|a×b| gives area of parallelogram formed by vectors a and b.",
            topic: "area"
        },
        {
            question: "Vectors (2,0) and (0,3) form parallelogram of area?",
            options: ["6", "5", "4", "3"],
            correctAnswer: 0,
            explanation: "Area = |2×3 - 0×0| = |6 - 0| = 6.",
            topic: "area"
        },
        {
            question: "If area is zero, vectors are?",
            options: ["Parallel", "Perpendicular", "Equal", "Opposite"],
            correctAnswer: 0,
            explanation: "Area=0 ⇒ |a×b|=0 ⇒ vectors are parallel.",
            topic: "area"
        },
        {
            question: "Area with vectors (1,1) and (2,2) is?",
            options: ["0", "1", "2", "3"],
            correctAnswer: 0,
            explanation: "Area = |1×2 - 1×2| = |2 - 2| = 0 (parallel vectors).",
            topic: "area"
        },
        {
            question: "Maximum area occurs when vectors are?",
            options: ["Perpendicular", "Parallel", "At 45°", "Opposite"],
            correctAnswer: 0,
            explanation: "Maximum area when sinθ=1 ⇒ θ=90° (perpendicular).",
            topic: "area"
        },
        {
            question: "Area of triangle formed by two vectors is?",
            options: ["Half of parallelogram", "Equal to parallelogram", "Double of parallelogram", "Quarter of parallelogram"],
            correctAnswer: 0,
            explanation: "Triangle area = ½ × parallelogram area.",
            topic: "area"
        },
        {
            question: "Find area: vectors (3,0,0) and (0,4,0)",
            options: ["12", "10", "8", "6"],
            correctAnswer: 0,
            explanation: "Area = |(3,0,0)×(0,4,0)| = |(0,0,12)| = 12.",
            topic: "area"
        },
        {
            question: "Area with vectors (2,3) and (4,1) is?",
            options: ["10", "11", "12", "13"],
            correctAnswer: 0,
            explanation: "Area = |2×1 - 3×4| = |2 - 12| = 10.",
            topic: "area"
        },
        {
            question: "If vectors are perpendicular, area equals?",
            options: ["Product of magnitudes", "Sum of magnitudes", "Difference of magnitudes", "Zero"],
            correctAnswer: 0,
            explanation: "When θ=90°, sinθ=1, area = |a||b|.",
            topic: "area"
        },
        {
            question: "Area using determinant of 2x2 matrix equals?",
            options: ["|ad - bc|", "ad + bc", "ab + cd", "ac + bd"],
            correctAnswer: 0,
            explanation: "For vectors (a,b) and (c,d), area = |ad - bc|.",
            topic: "area"
        },
        {
            question: "Vectors (1,2) and (3,6) form area of?",
            options: ["0", "4", "8", "12"],
            correctAnswer: 0,
            explanation: "Area = |1×6 - 2×3| = |6 - 6| = 0 (parallel vectors).",
            topic: "area"
        },
        {
            question: "Cross product gives area of?",
            options: ["Parallelogram", "Triangle", "Rectangle", "Circle"],
            correctAnswer: 0,
            explanation: "Magnitude of cross product gives parallelogram area.",
            topic: "area"
        },

        // Normalization Topic (15 questions)
        {
            question: "What is the unit vector in the direction of (3, 4)?",
            options: ["(0.6, 0.8)", "(0.5, 0.5)", "(0.7, 0.7)", "(0.8, 0.6)"],
            correctAnswer: 0,
            explanation: "Magnitude = √(3²+4²) = 5. Unit vector = (3/5, 4/5) = (0.6, 0.8).",
            topic: "normalization"
        },
        {
            question: "What is the magnitude of vector (6, 8)?",
            options: ["10", "12", "14", "16"],
            correctAnswer: 0,
            explanation: "The magnitude is √(6² + 8²) = √(36 + 64) = √100 = 10.",
            topic: "normalization"
        },
        {
            question: "Unit vector of (1,0) is?",
            options: ["(1,0)", "(0,1)", "(0.5,0.5)", "(0,0)"],
            correctAnswer: 0,
            explanation: "Magnitude=1, so it's already a unit vector.",
            topic: "normalization"
        },
        {
            question: "Find unit vector of (4,3).",
            options: ["(0.8,0.6)", "(0.6,0.8)", "(0.4,0.3)", "(0.3,0.4)"],
            correctAnswer: 0,
            explanation: "Magnitude=5, unit vector=(4/5,3/5)=(0.8,0.6).",
            topic: "normalization"
        },
        {
            question: "Magnitude of (0,0) is?",
            options: ["0", "1", "2", "Undefined"],
            correctAnswer: 0,
            explanation: "√(0²+0²)=0.",
            topic: "normalization"
        },
        {
            question: "Unit vector has magnitude?",
            options: ["1", "0", "2", "Depends on vector"],
            correctAnswer: 0,
            explanation: "By definition, unit vector has magnitude 1.",
            topic: "normalization"
        },
        {
            question: "Normalize vector (12,5).",
            options: ["(0.923,0.385)", "(0.8,0.6)", "(0.6,0.8)", "(0.385,0.923)"],
            correctAnswer: 0,
            explanation: "Magnitude=13, unit vector=(12/13,5/13)≈(0.923,0.385).",
            topic: "normalization"
        },
        {
            question: "Find magnitude of (1,1,1).",
            options: ["√3", "3", "1", "2"],
            correctAnswer: 0,
            explanation: "√(1²+1²+1²)=√3.",
            topic: "normalization"
        },
        {
            question: "Unit vector opposite to (1,0) is?",
            options: ["(-1,0)", "(0,-1)", "(-1,-1)", "(0,1)"],
            correctAnswer: 0,
            explanation: "Same magnitude, opposite direction.",
            topic: "normalization"
        },
        {
            question: "Normalize vector (0,5).",
            options: ["(0,1)", "(1,0)", "(0,0.2)", "(0.2,0)"],
            correctAnswer: 0,
            explanation: "Magnitude=5, unit vector=(0,1).",
            topic: "normalization"
        },
        {
            question: "Magnitude formula for (x,y,z) is?",
            options: ["√(x²+y²+z²)", "x+y+z", "x²+y²+z²", "√(x+y+z)"],
            correctAnswer: 0,
            explanation: "Standard magnitude formula in 3D.",
            topic: "normalization"
        },
        {
            question: "Unit vector of (2,2) is?",
            options: ["(0.707,0.707)", "(0.5,0.5)", "(1,1)", "(0.8,0.8)"],
            correctAnswer: 0,
            explanation: "Magnitude=√8=2√2≈2.828, unit vector=(2/2.828,2/2.828)≈(0.707,0.707).",
            topic: "normalization"
        },
        {
            question: "If vector is zero, its unit vector is?",
            options: ["Undefined", "(0,0)", "(1,1)", "(0,1)"],
            correctAnswer: 0,
            explanation: "Cannot normalize zero vector (division by zero).",
            topic: "normalization"
        },
        {
            question: "Find magnitude of (3,4,0).",
            options: ["5", "7", "12", "25"],
            correctAnswer: 0,
            explanation: "√(3²+4²+0²)=√(9+16)=√25=5.",
            topic: "normalization"
        },
        {
            question: "Unit vector preserves?",
            options: ["Direction", "Magnitude", "Both direction and magnitude", "Neither"],
            correctAnswer: 0,
            explanation: "Unit vector preserves direction but changes magnitude to 1.",
            topic: "normalization"
        }
    ],
    medium: [
        // Torque Topic (15 questions)
        {
            question: "Calculate the cross product of vectors (2, 3, 1) and (4, -1, 3).",
            options: ["(10, -2, -14)", "(8, -3, 3)", "(5, 2, -10)", "(12, -4, 6)"],
            correctAnswer: 0,
            explanation: "Cross product = (3×3 - 1×(-1), 1×4 - 2×3, 2×(-1) - 3×4) = (9+1, 4-6, -2-12) = (10, -2, -14).",
            topic: "torque"
        },
        {
            question: "What is the torque produced by a 12N force applied 0.5m from a pivot at 60°?",
            options: ["3 N·m", "5.2 N·m", "6 N·m", "4.5 N·m"],
            correctAnswer: 1,
            explanation: "Torque = r × F × sin(θ) = 0.5 × 12 × sin(60°) = 6 × 0.866 = 5.2 N·m.",
            topic: "torque"
        },
        {
            question: "Torque is maximum when angle between r and F is?",
            options: ["90°", "0°", "45°", "180°"],
            correctAnswer: 0,
            explanation: "Maximum torque when sinθ=1 ⇒ θ=90°.",
            topic: "torque"
        },
        {
            question: "Calculate torque: r=(2,0,0), F=(0,3,0)",
            options: ["(0,0,6)", "(6,0,0)", "(0,6,0)", "(0,0,-6)"],
            correctAnswer: 0,
            explanation: "r×F = (0×0-0×3, 0×0-2×0, 2×3-0×0) = (0,0,6).",
            topic: "torque"
        },
        {
            question: "Torque vector is perpendicular to?",
            options: ["Both r and F", "Only r", "Only F", "Neither r nor F"],
            correctAnswer: 0,
            explanation: "Cross product gives vector perpendicular to both input vectors.",
            topic: "torque"
        },
        {
            question: "Find torque: r=(1,2,3), F=(4,5,6)",
            options: ["(-3,6,-3)", "(3,-6,3)", "(-3,-6,-3)", "(3,6,3)"],
            correctAnswer: 0,
            explanation: "r×F = (2×6-3×5, 3×4-1×6, 1×5-2×4) = (12-15,12-6,5-8)=(-3,6,-3).",
            topic: "torque"
        },
        {
            question: "Zero torque occurs when?",
            options: ["r and F are parallel", "r and F are perpendicular", "r is zero", "F is zero"],
            correctAnswer: 0,
            explanation: "Torque=0 when sinθ=0 ⇒ θ=0° or 180° (parallel vectors).",
            topic: "torque"
        },
        {
            question: "Right-hand rule for torque gives?",
            options: ["Direction of torque", "Magnitude of torque", "Both direction and magnitude", "Neither"],
            correctAnswer: 0,
            explanation: "Right-hand rule gives direction of torque vector.",
            topic: "torque"
        },
        {
            question: "Torque units are?",
            options: ["N·m", "J", "N/m", "m/N"],
            correctAnswer: 0,
            explanation: "Torque = force × distance ⇒ N·m.",
            topic: "torque"
        },
        {
            question: "Calculate torque magnitude: |r|=2m, |F|=5N, θ=30°",
            options: ["5 N·m", "10 N·m", "15 N·m", "20 N·m"],
            correctAnswer: 0,
            explanation: "τ = 2×5×sin30°=10×0.5=5 N·m.",
            topic: "torque"
        },
        {
            question: "Torque is a measure of?",
            options: ["Rotational effect", "Linear motion", "Energy", "Power"],
            correctAnswer: 0,
            explanation: "Torque causes rotational motion.",
            topic: "torque"
        },
        {
            question: "Find torque: r=(0,3,0), F=(4,0,0)",
            options: ["(0,0,-12)", "(0,0,12)", "(12,0,0)", "(0,12,0)"],
            correctAnswer: 0,
            explanation: "r×F = (3×0-0×0, 0×4-0×0, 0×0-3×4) = (0,0,-12).",
            topic: "torque"
        },
        {
            question: "Lever arm is?",
            options: ["Perpendicular distance", "Parallel distance", "Total distance", "Horizontal distance"],
            correctAnswer: 0,
            explanation: "Lever arm is perpendicular distance from pivot to force line.",
            topic: "torque"
        },
        {
            question: "Torque in vector form is?",
            options: ["r × F", "r · F", "F × r", "r + F"],
            correctAnswer: 0,
            explanation: "Torque = position vector × force vector.",
            topic: "torque"
        },
        {
            question: "For same force, torque increases with?",
            options: ["Lever arm", "Angle", "Both lever arm and angle", "Neither"],
            correctAnswer: 2,
            explanation: "Torque increases with both lever arm and angle (up to 90°).",
            topic: "torque"
        },

        // Work Topic (Medium Level - 15 questions)
        {
            question: "Find the angle between vectors (1, 2, 3) and (4, 5, 6).",
            options: ["12.9°", "15.2°", "18.5°", "22.1°"],
            correctAnswer: 0,
            explanation: "Dot product = 32, |v1| = √14 ≈ 3.74, |v2| = √77 ≈ 8.77, cosθ = 32/(3.74×8.77) ≈ 0.975, θ ≈ 12.9°.",
            topic: "work"
        },
        {
            question: "What is the projection of vector (3, 4) onto (1, 2)?",
            options: ["(2.2, 4.4)", "(1.5, 3)", "(2, 4)", "(2.5, 5)"],
            correctAnswer: 0,
            explanation: "Scalar = (3×1+4×2)/(1×1+2×2) = 11/5 = 2.2, Projection = 2.2×(1,2) = (2.2,4.4).",
            topic: "work"
        },
        {
            question: "Work done is scalar because?",
            options: ["Dot product gives scalar", "Cross product gives scalar", "Vector sum gives scalar", "All of above"],
            correctAnswer: 0,
            explanation: "Work = F·d, and dot product of two vectors is a scalar.",
            topic: "work"
        },
        {
            question: "If F and d are in same direction, work is?",
            options: ["Positive", "Negative", "Zero", "Infinite"],
            correctAnswer: 0,
            explanation: "Same direction ⇒ θ=0° ⇒ cosθ=1 ⇒ positive work.",
            topic: "work"
        },
        {
            question: "Work done against gravity is?",
            options: ["Positive", "Negative", "Zero", "Depends on direction"],
            correctAnswer: 0,
            explanation: "Lifting object ⇒ displacement opposite to gravity ⇒ positive work.",
            topic: "work"
        },
        {
            question: "Find work: F=(2,3,1), d=(4,1,2)",
            options: ["15 J", "16 J", "17 J", "18 J"],
            correctAnswer: 0,
            explanation: "Work = (2×4)+(3×1)+(1×2)=8+3+2=13 J.",
            topic: "work"
        },
        {
            question: "Work-energy theorem states?",
            options: ["W = ΔK", "W = ΔP", "W = ΔE", "W = Fd"],
            correctAnswer: 0,
            explanation: "Work done = Change in kinetic energy.",
            topic: "work"
        },
        {
            question: "If work is zero, object's speed?",
            options: ["Constant", "Increasing", "Decreasing", "Zero"],
            correctAnswer: 0,
            explanation: "Zero work ⇒ no change in kinetic energy ⇒ constant speed.",
            topic: "work"
        },
        {
            question: "Work done by conservative force depends on?",
            options: ["Path", "End points only", "Both path and endpoints", "Neither"],
            correctAnswer: 1,
            explanation: "Conservative force work depends only on initial and final positions.",
            topic: "work"
        },
        {
            question: "Power is?",
            options: ["Work/time", "Force/area", "Energy/mass", "Velocity/time"],
            correctAnswer: 0,
            explanation: "Power = Work done / Time taken.",
            topic: "work"
        },
        {
            question: "1 Joule equals?",
            options: ["1 N·m", "1 kg·m/s", "1 m/s²", "1 N/s"],
            correctAnswer: 0,
            explanation: "1 J = 1 N·m.",
            topic: "work"
        },
        {
            question: "Work done by friction is usually?",
            options: ["Negative", "Positive", "Zero", "Infinite"],
            correctAnswer: 0,
            explanation: "Friction opposes motion ⇒ negative work.",
            topic: "work"
        },
        {
            question: "If F=(0,0,10) and d=(0,0,5), work is?",
            options: ["50 J", "0 J", "25 J", "100 J"],
            correctAnswer: 0,
            explanation: "Work = (0×0)+(0×0)+(10×5)=50 J.",
            topic: "work"
        },
        {
            question: "Work is path independent for?",
            options: ["Conservative forces", "Non-conservative forces", "All forces", "No forces"],
            correctAnswer: 0,
            explanation: "Conservative forces have path-independent work.",
            topic: "work"
        },
        {
            question: "Scalar product is commutative because?",
            options: ["a·b = b·a", "a×b = b×a", "a+b = b+a", "a-b = b-a"],
            correctAnswer: 0,
            explanation: "Dot product is commutative: a·b = b·a.",
            topic: "work"
        },

        // Normal Vectors Topic (15 questions)
        {
            question: "Find the normal vector to the plane defined by vectors (3, 1, 2) and (1, 2, 3).",
            options: ["(-1, -7, 5)", "(2, 4, -3)", "(-2, 5, -1)", "(1, -4, 2)"],
            correctAnswer: 0,
            explanation: "Cross product = (1×3-2×2, 2×1-3×3, 3×2-1×1) = (3-4, 2-9, 6-1) = (-1, -7, 5).",
            topic: "normal"
        },
        {
            question: "Normal vector to xy-plane is?",
            options: ["(0,0,1)", "(1,0,0)", "(0,1,0)", "(1,1,1)"],
            correctAnswer: 0,
            explanation: "xy-plane has equation z=0, normal vector is (0,0,1).",
            topic: "normal"
        },
        {
            question: "Two vectors in a plane, their cross product gives?",
            options: ["Normal to plane", "Vector in plane", "Zero vector", "Unit vector"],
            correctAnswer: 0,
            explanation: "Cross product of two plane vectors gives normal to the plane.",
            topic: "normal"
        },
        {
            question: "Find normal to plane containing (1,0,0) and (0,1,0)",
            options: ["(0,0,1)", "(1,1,0)", "(0,1,1)", "(1,0,1)"],
            correctAnswer: 0,
            explanation: "(1,0,0)×(0,1,0)=(0,0,1).",
            topic: "normal"
        },
        {
            question: "Unit normal vector has magnitude?",
            options: ["1", "0", "Same as original", "Depends on plane"],
            correctAnswer: 0,
            explanation: "Unit vector always has magnitude 1.",
            topic: "normal"
        },
        {
            question: "Normal vector is used to find?",
            options: ["Plane equation", "Distance to plane", "Both A and B", "Neither"],
            correctAnswer: 2,
            explanation: "Normal vector helps define plane equation and calculate distances.",
            topic: "normal"
        },
        {
            question: "If normal is (1,2,3), plane equation could be?",
            options: ["x+2y+3z+d=0", "3x+2y+z+d=0", "2x+3y+z+d=0", "x+y+z+d=0"],
            correctAnswer: 0,
            explanation: "Plane equation: a(x-x₀)+b(y-y₀)+c(z-z₀)=0 where (a,b,c) is normal.",
            topic: "normal"
        },
        {
            question: "Find normal to plane through (1,2,3), (4,5,6), (7,8,9)",
            options: ["(0,0,0)", "(1,1,1)", "(-1,-1,-1)", "Undefined"],
            correctAnswer: 0,
            explanation: "Points are collinear ⇒ no unique plane ⇒ normal is zero vector.",
            topic: "normal"
        },
        {
            question: "Normal vector is perpendicular to?",
            options: ["Every vector in plane", "Only one vector in plane", "No vectors in plane", "Itself"],
            correctAnswer: 0,
            explanation: "Normal is perpendicular to all vectors in the plane.",
            topic: "normal"
        },
        {
            question: "For plane ax+by+cz+d=0, normal is?",
            options: ["(a,b,c)", "(b,c,a)", "(c,a,b)", "(d,a,b)"],
            correctAnswer: 0,
            explanation: "Coefficients (a,b,c) give the normal vector.",
            topic: "normal"
        },
        {
            question: "Find normal to plane: 2x-3y+4z-5=0",
            options: ["(2,-3,4)", "(-2,3,-4)", "(4,-3,2)", "(2,3,4)"],
            correctAnswer: 0,
            explanation: "Normal vector = (2,-3,4).",
            topic: "normal"
        },
        {
            question: "Two parallel planes have?",
            options: ["Same normal", "Different normals", "Perpendicular normals", "No normals"],
            correctAnswer: 0,
            explanation: "Parallel planes have parallel (same) normal vectors.",
            topic: "normal"
        },
        {
            question: "Normal vector determines plane's?",
            options: ["Orientation", "Position", "Size", "Shape"],
            correctAnswer: 0,
            explanation: "Normal vector determines orientation, not position.",
            topic: "normal"
        },
        {
            question: "Find unit normal to plane with normal (3,0,4)",
            options: ["(0.6,0,0.8)", "(0.8,0,0.6)", "(0.5,0,0.5)", "(1,0,1)"],
            correctAnswer: 0,
            explanation: "Magnitude=5, unit normal=(3/5,0,4/5)=(0.6,0,0.8).",
            topic: "normal"
        },
        {
            question: "If normal is zero vector, the plane is?",
            options: ["Undefined", "Horizontal", "Vertical", "At 45°"],
            correctAnswer: 0,
            explanation: "Zero normal ⇒ invalid plane equation.",
            topic: "normal"
        }
    ],
    hard: [
        // Distance Topic (15 questions)
        {
            question: "Calculate the distance from point (2, 3, 4) to the plane x + y + z - 5 = 0.",
            options: ["1.15 units", "2.31 units", "0.58 units", "3.46 units"],
            correctAnswer: 1,
            explanation: "Distance = |1×2+1×3+1×4-5|/√(1²+1²+1²) = |2+3+4-5|/√3 = |4|/√3 ≈ 2.31.",
            topic: "distance"
        },
        {
            question: "Distance from (1,2,3) to plane 2x-y+2z-8=0 is?",
            options: ["1", "2", "3", "4"],
            correctAnswer: 0,
            explanation: "Distance = |2×1-1×2+2×3-8|/√(4+1+4) = |2-2+6-8|/3 = | -2|/3 ≈ 0.67.",
            topic: "distance"
        },
        {
            question: "Distance formula uses?",
            options: ["Absolute value", "Square root", "Both A and B", "Neither"],
            correctAnswer: 2,
            explanation: "Distance = |ax₀+by₀+cz₀+d|/√(a²+b²+c²).",
            topic: "distance"
        },
        {
            question: "Point on plane closest to given point lies along?",
            options: ["Normal direction", "Any direction", "Tangent direction", "Random direction"],
            correctAnswer: 0,
            explanation: "Shortest distance is along normal to the plane.",
            topic: "distance"
        },
        {
            question: "Distance from origin to plane ax+by+cz+d=0 is?",
            options: ["|d|/√(a²+b²+c²)", "d/√(a²+b²+c²)", "|a+b+c+d|", "√(a²+b²+c²)/|d|"],
            correctAnswer: 0,
            explanation: "Set (x₀,y₀,z₀)=(0,0,0) in distance formula.",
            topic: "distance"
        },
        {
            question: "If point lies on plane, distance is?",
            options: ["0", "1", "Undefined", "Infinite"],
            correctAnswer: 0,
            explanation: "Point on plane satisfies plane equation ⇒ distance=0.",
            topic: "distance"
        },
        {
            question: "Find distance from (1,1,1) to plane x+y+z-3=0",
            options: ["0", "1", "√3", "3"],
            correctAnswer: 0,
            explanation: "Point satisfies equation: 1+1+1-3=0 ⇒ distance=0.",
            topic: "distance"
        },
        {
            question: "Distance is always?",
            options: ["Non-negative", "Positive", "Negative", "Zero"],
            correctAnswer: 0,
            explanation: "Distance is always ≥ 0 (absolute value in numerator).",
            topic: "distance"
        },
        {
            question: "For parallel planes, distance between them is?",
            options: ["Constant", "Variable", "Zero", "Infinite"],
            correctAnswer: 0,
            explanation: "Distance between parallel planes is constant.",
            topic: "distance"
        },
        {
            question: "Find distance from (0,0,0) to plane 3x+4z-5=0",
            options: ["1", "2", "3", "4"],
            correctAnswer: 0,
            explanation: "Distance = |3×0+4×0-5|/√(9+0+16)=5/5=1.",
            topic: "distance"
        },
        {
            question: "Distance from point to plane is?",
            options: ["Shortest distance", "Longest distance", "Average distance", "Random distance"],
            correctAnswer: 0,
            explanation: "The formula gives the perpendicular (shortest) distance.",
            topic: "distance"
        },
        {
            question: "If plane equation is multiplied by constant, distance?",
            options: ["Remains same", "Changes", "Becomes zero", "Becomes infinite"],
            correctAnswer: 0,
            explanation: "Multiplying equation by constant doesn't change distance.",
            topic: "distance"
        },
        {
            question: "Find distance from (2,3,4) to plane x-2y+2z-9=0",
            options: ["1", "2", "3", "4"],
            correctAnswer: 0,
            explanation: "Distance = |2-6+8-9|/√(1+4+4)=| -5|/3=5/3≈1.67.",
            topic: "distance"
        },
        {
            question: "Distance formula denominator is?",
            options: ["Magnitude of normal", "Dot product of normals", "Area of plane", "Volume"],
            correctAnswer: 0,
            explanation: "Denominator = √(a²+b²+c²) = magnitude of normal vector.",
            topic: "distance"
        },
        {
            question: "For plane through origin (d=0), distance from origin is?",
            options: ["0", "1", "Undefined", "Infinite"],
            correctAnswer: 0,
            explanation: "Origin lies on plane when d=0 ⇒ distance=0.",
            topic: "distance"
        },

        // Line Topic (15 questions)
        {
            question: "What is the line of intersection of planes 2x+y-z=3 and x-y+2z=1?",
            options: ["r=(1,0,0)+t(1,-5,-3)", "r=(0,1,2)+t(2,1,-1)", "r=(2,1,0)+t(1,2,3)", "r=(1,1,1)+t(3,-2,1)"],
            correctAnswer: 0,
            explanation: "Direction vector = (2,1,-1)×(1,-1,2) = (1,-5,-3). Solve system to find point (1,0,0).",
            topic: "line"
        },
        {
            question: "Vector equation of line requires?",
            options: ["Point and direction", "Two points", "Slope and intercept", "Angle and length"],
            correctAnswer: 0,
            explanation: "r = r₀ + tv, where r₀ is point and v is direction vector.",
            topic: "line"
        },
        {
            question: "Find line through (1,2,3) with direction (4,5,6)",
            options: ["r=(1,2,3)+t(4,5,6)", "r=(4,5,6)+t(1,2,3)", "r=(1,4,2)+t(2,5,3)", "r=(3,2,1)+t(6,5,4)"],
            correctAnswer: 0,
            explanation: "Standard form: point + t(direction).",
            topic: "line"
        },
        {
            question: "Two lines are parallel if their direction vectors are?",
            options: ["Scalar multiples", "Perpendicular", "Equal", "Opposite"],
            correctAnswer: 0,
            explanation: "Parallel lines have proportional direction vectors.",
            topic: "line"
        },
        {
            question: "Find point on line r=(1,2,3)+t(4,5,6) when t=2",
            options: ["(9,12,15)", "(5,7,9)", "(8,10,12)", "(10,14,18)"],
            correctAnswer: 0,
            explanation: "r = (1+8, 2+10, 3+12) = (9,12,15).",
            topic: "line"
        },
        {
            question: "Line in 3D has how many parametric equations?",
            options: ["3", "2", "1", "4"],
            correctAnswer: 0,
            explanation: "x=x₀+at, y=y₀+bt, z=z₀+ct (three equations).",
            topic: "line"
        },
        {
            question: "Direction ratios are?",
            options: ["Components of direction vector", "Angles with axes", "Lengths of line", "Coordinates of points"],
            correctAnswer: 0,
            explanation: "Direction ratios = (a,b,c) from direction vector (a,b,c).",
            topic: "line"
        },
        {
            question: "Find direction vector of line through (1,2,3) and (4,5,6)",
            options: ["(3,3,3)", "(1,1,1)", "(2,2,2)", "(4,4,4)"],
            correctAnswer: 0,
            explanation: "Direction = (4-1,5-2,6-3)=(3,3,3).",
            topic: "line"
        },
        {
            question: "Line parallel to x-axis has direction?",
            options: ["(1,0,0)", "(0,1,0)", "(0,0,1)", "(1,1,1)"],
            correctAnswer: 0,
            explanation: "Parallel to x-axis ⇒ direction vector (1,0,0).",
            topic: "line"
        },
        {
            question: "Parametric form is useful for?",
            options: ["Finding points on line", "Finding intersection", "Both A and B", "Neither"],
            correctAnswer: 2,
            explanation: "Parametric form helps find points and intersections.",
            topic: "line"
        },
        {
            question: "If two lines intersect, they are?",
            options: ["Coplanar", "Non-coplanar", "Parallel", "Skew"],
            correctAnswer: 0,
            explanation: "Intersecting lines always lie in the same plane.",
            topic: "line"
        },
        {
            question: "Skew lines are?",
            options: ["Non-coplanar and non-parallel", "Coplanar and parallel", "Intersecting", "Perpendicular"],
            correctAnswer: 0,
            explanation: "Skew lines don't intersect and aren't parallel.",
            topic: "line"
        },
        {
            question: "Find line parallel to (1,2,3) through (0,0,0)",
            options: ["r=t(1,2,3)", "r=(1,2,3)+t(0,0,0)", "r=(0,0,0)+t(2,4,6)", "r=t(2,3,4)"],
            correctAnswer: 0,
            explanation: "Through origin with given direction.",
            topic: "line"
        },
        {
            question: "Angle between two lines depends on?",
            options: ["Their direction vectors", "Their points", "Both A and B", "Neither"],
            correctAnswer: 0,
            explanation: "Angle between lines = angle between their direction vectors.",
            topic: "line"
        },
        {
            question: "Line perpendicular to both (1,0,0) and (0,1,0) has direction?",
            options: ["(0,0,1)", "(1,1,0)", "(0,1,1)", "(1,0,1)"],
            correctAnswer: 0,
            explanation: "(1,0,0)×(0,1,0)=(0,0,1).",
            topic: "line"
        },

        // Velocity Topic (15 questions)
        {
            question: "Find the shortest distance between skew lines: r=(1,2,3)+t(1,1,1) and r=(4,5,6)+s(2,-1,1).",
            options: ["0 units", "1.5 units", "2.2 units", "3.1 units"],
            correctAnswer: 0,
            explanation: "The lines intersect (check by solving system), so shortest distance is 0.",
            topic: "velocity"
        },
        {
            question: "Resultant velocity is?",
            options: ["Vector sum of velocities", "Scalar sum of speeds", "Average velocity", "Maximum velocity"],
            correctAnswer: 0,
            explanation: "Resultant velocity = vector sum of all velocity vectors.",
            topic: "velocity"
        },
        {
            question: "A boat crosses river with velocity. Resultant depends on?",
            options: ["Boat velocity and current", "Only boat velocity", "Only current", "Neither"],
            correctAnswer: 0,
            explanation: "Resultant = boat velocity + current velocity.",
            topic: "velocity"
        },
        {
            question: "If v1=(3,0) and v2=(0,4), resultant is?",
            options: ["(3,4)", "(0,0)", "(3,0)", "(0,4)"],
            correctAnswer: 0,
            explanation: "Vector sum = (3+0, 0+4) = (3,4).",
            topic: "velocity"
        },
        {
            question: "Magnitude of resultant velocity is?",
            options: ["√(vx²+vy²+vz²)", "vx+vy+vz", "vx×vy×vz", "(vx+vy+vz)/3"],
            correctAnswer: 0,
            explanation: "Standard magnitude formula for resultant vector.",
            topic: "velocity"
        },
        {
            question: "For perpendicular velocities, resultant magnitude is?",
            options: ["√(v1²+v2²)", "v1+v2", "v1-v2", "v1×v2"],
            correctAnswer: 0,
            explanation: "Pythagorean theorem for perpendicular vectors.",
            topic: "velocity"
        },
        {
            question: "Relative velocity of A wrt B is?",
            options: ["vA - vB", "vA + vB", "vB - vA", "vA × vB"],
            correctAnswer: 0,
            explanation: "v_AB = v_A - v_B.",
            topic: "velocity"
        },
        {
            question: "If two velocities are equal and opposite, resultant is?",
            options: ["Zero", "Twice individual", "Same as individual", "Half of individual"],
            correctAnswer: 0,
            explanation: "v + (-v) = 0.",
            topic: "velocity"
        },
        {
            question: "Find resultant of (2,3) and (1,4)",
            options: ["(3,7)", "(1,1)", "(2,4)", "(3,3)"],
            correctAnswer: 0,
            explanation: "(2+1, 3+4) = (3,7).",
            topic: "velocity"
        },
        {
            question: "Velocity vector indicates?",
            options: ["Speed and direction", "Only speed", "Only direction", "Acceleration"],
            correctAnswer: 0,
            explanation: "Velocity vector gives both magnitude (speed) and direction.",
            topic: "velocity"
        },
        {
            question: "For maximum resultant, angle between velocities should be?",
            options: ["0°", "90°", "180°", "45°"],
            correctAnswer: 0,
            explanation: "Maximum resultant when vectors are in same direction (θ=0°).",
            topic: "velocity"
        },
        {
            question: "For minimum resultant, angle should be?",
            options: ["180°", "0°", "90°", "45°"],
            correctAnswer: 0,
            explanation: "Minimum resultant when vectors are opposite (θ=180°).",
            topic: "velocity"
        },
        {
            question: "Airplane with airspeed and wind has ground velocity =?",
            options: ["Airspeed + wind velocity", "Airspeed - wind velocity", "Wind velocity - airspeed", "Airspeed × wind velocity"],
            correctAnswer: 0,
            explanation: "Ground velocity = air velocity + wind velocity.",
            topic: "velocity"
        },
        {
            question: "If v1=(4,0) and v2=(3,0), resultant is?",
            options: ["(7,0)", "(1,0)", "(4,3)", "(3,4)"],
            correctAnswer: 0,
            explanation: "Same direction ⇒ simple addition.",
            topic: "velocity"
        },
        {
            question: "Resultant of three equal magnitudes at 120° is?",
            options: ["Zero", "Three times", "Twice", "Same as one"],
            correctAnswer: 0,
            explanation: "Three equal vectors at 120° cancel out ⇒ zero resultant.",
            topic: "velocity"
        }
    ]
};

// Quiz Functions
function generateQuiz() {
    // Show customization options
    document.getElementById('quiz-customization').style.display = 'block';
    document.getElementById('quiz-interface').style.display = 'none';
    document.getElementById('quiz-results').style.display = 'none';
}

function generateCustomQuiz() {
    const length = parseInt(document.getElementById('quiz-length').value);
    const difficulty = document.getElementById('quiz-difficulty').value;
    
    // Get selected topics
    const selectedTopics = [];
    if (document.getElementById('topic-work').checked) selectedTopics.push('work');
    if (document.getElementById('topic-area').checked) selectedTopics.push('area');
    if (document.getElementById('topic-torque').checked) selectedTopics.push('torque');
    if (document.getElementById('topic-normal').checked) selectedTopics.push('normal');
    if (document.getElementById('topic-velocity').checked) selectedTopics.push('velocity');
    
    // If no topics selected, use all topics
    if (selectedTopics.length === 0) {
        selectedTopics.push('work', 'area', 'torque', 'normal', 'velocity');
    }
    
    // Filter questions by difficulty and topic
    let availableQuestions = quizQuestions[difficulty].filter(q => 
        selectedTopics.includes(q.topic)
    );
    
    // Shuffle and select questions
    availableQuestions = shuffleArray(availableQuestions);
    currentQuiz = availableQuestions.slice(0, Math.min(length, availableQuestions.length));
    
    // Initialize quiz state
    currentQuestionIndex = 0;
    userAnswers = new Array(currentQuiz.length).fill(null);
    quizScore = 0;
    
    // Show quiz interface
    document.getElementById('quiz-customization').style.display = 'none';
    document.getElementById('quiz-interface').style.display = 'block';
    document.getElementById('quiz-results').style.display = 'none';
    
    // Update progress
    document.getElementById('total-questions').textContent = currentQuiz.length;
    
    // Display first question
    displayQuestion();
}
function displayQuestion() {
    const question = currentQuiz[currentQuestionIndex];
    
    // Update progress bar
    const progress = ((currentQuestionIndex + 1) / currentQuiz.length) * 100;
    document.getElementById('quiz-progress-bar').style.width = `${progress}%`;
    document.getElementById('current-question').textContent = currentQuestionIndex + 1;
    
    // Display question
    document.getElementById('question-text').textContent = question.question;
    
    // Display options
    const optionsContainer = document.getElementById('question-options');
    optionsContainer.innerHTML = '';
    
    question.options.forEach((option, index) => {
        const optionDiv = document.createElement('div');
        optionDiv.className = 'form-check';
        
        const input = document.createElement('input');
        input.className = 'form-check-input';
        input.type = 'radio';
        input.name = 'quiz-option';
        input.id = `option-${index}`;
        input.value = index;
        input.checked = userAnswers[currentQuestionIndex] === index;
        
        input.addEventListener('change', function() {
            userAnswers[currentQuestionIndex] = parseInt(this.value);
            updateQuizControls();
        });
        
        const label = document.createElement('label');
        label.className = 'form-check-label';
        label.htmlFor = `option-${index}`;
        label.textContent = option;
        
        optionDiv.appendChild(input);
        optionDiv.appendChild(label);
        optionsContainer.appendChild(optionDiv);
    });
    
    // Hide feedback
    document.getElementById('quiz-feedback').style.display = 'none';
    
    // Update controls
    updateQuizControls();
}

function updateQuizControls() {
    // Previous button
    document.getElementById('prev-question').disabled = currentQuestionIndex === 0;
    
    // Next/Submit button
    const hasAnswer = userAnswers[currentQuestionIndex] !== null;
    
    if (currentQuestionIndex === currentQuiz.length - 1) {
        document.getElementById('next-question').style.display = 'none';
        document.getElementById('submit-quiz').style.display = hasAnswer ? 'inline-block' : 'none';
    } else {
        document.getElementById('next-question').style.display = 'inline-block';
        document.getElementById('submit-quiz').style.display = 'none';
        document.getElementById('next-question').disabled = !hasAnswer;
    }
}

function prevQuestion() {
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        displayQuestion();
    }
}

function nextQuestion() {
    if (currentQuestionIndex < currentQuiz.length - 1 && userAnswers[currentQuestionIndex] !== null) {
        currentQuestionIndex++;
        displayQuestion();
    }
}

function submitQuiz() {
    // Calculate score
    quizScore = 0;
    currentQuiz.forEach((question, index) => {
        if (userAnswers[index] === question.correctAnswer) {
            quizScore++;
        }
    });
    
    // Display results
    const percentage = Math.round((quizScore / currentQuiz.length) * 100);
    
    document.getElementById('quiz-score').textContent = quizScore;
    document.getElementById('quiz-max-score').textContent = currentQuiz.length;
    document.getElementById('quiz-percentage').textContent = percentage;
    
    // Determine grade
    let grade, feedback;
    if (percentage >= 90) {
        grade = "Excellent!";
        feedback = "You have a strong understanding of vector physics concepts.";
    } else if (percentage >= 70) {
        grade = "Good job!";
        feedback = "You understand the main concepts but could use some practice on specific topics.";
    } else if (percentage >= 50) {
        grade = "Fair";
        feedback = "You have a basic understanding but should review the material more thoroughly.";
    } else {
        grade = "Needs Improvement";
        feedback = "Consider reviewing the vector physics concepts and practicing more problems.";
    }
    
    document.getElementById('quiz-grade').textContent = grade;
    document.getElementById('quiz-feedback-text').textContent = feedback;
    
    // Show results
    document.getElementById('quiz-interface').style.display = 'none';
    document.getElementById('quiz-results').style.display = 'block';
    
    // Generate personalized recommendations based on performance
    generateRecommendations();
}

function generateRecommendations() {
    // Analyze which topics the user struggled with
    const topicPerformance = {};
    
    currentQuiz.forEach((question, index) => {
        const topic = question.topic;
        if (!topicPerformance[topic]) {
            topicPerformance[topic] = { correct: 0, total: 0 };
        }
        
        topicPerformance[topic].total++;
        if (userAnswers[index] === question.correctAnswer) {
            topicPerformance[topic].correct++;
        }
    });
    
    // Find weak areas
    const weakTopics = [];
    for (const topic in topicPerformance) {
        const performance = topicPerformance[topic];
        const percentage = (performance.correct / performance.total) * 100;
        
        if (percentage < 70) {
            weakTopics.push(topic);
        }
    }
    
    // Add recommendations to feedback
    if (weakTopics.length > 0) {
        const feedbackElement = document.getElementById('quiz-feedback-text');
        feedbackElement.innerHTML += `<br><br><strong>Areas to focus on:</strong> ${weakTopics.map(t => t.charAt(0).toUpperCase() + t.slice(1)).join(', ')}.`;
        feedbackElement.innerHTML += `<br>Consider practicing more problems in these areas using the calculators above.`;
    }
}

function showQuizReview() {
    const reviewContainer = document.getElementById('question-review-list');
    reviewContainer.innerHTML = '';
    
    currentQuiz.forEach((question, index) => {
        const isCorrect = userAnswers[index] === question.correctAnswer;
        const userAnswer = userAnswers[index] !== null ? question.options[userAnswers[index]] : "Not answered";
        const correctAnswer = question.options[question.correctAnswer];
        
        const questionDiv = document.createElement('div');
        questionDiv.className = `step-explanation ${isCorrect ? 'border-success' : 'border-danger'}`;
        questionDiv.style.borderLeft = `3px solid ${isCorrect ? '#28a745' : '#dc3545'}`;
        
        questionDiv.innerHTML = `
            <p><strong>Question ${index + 1}:</strong> ${question.question}</p>
            <p><strong>Your answer:</strong> ${userAnswer} ${isCorrect ? '✓' : '✗'}</p>
            ${!isCorrect ? `<p><strong>Correct answer:</strong> ${correctAnswer}</p>` : ''}
            <p><strong>Explanation:</strong> ${question.explanation}</p>
        `;
        
        reviewContainer.appendChild(questionDiv);
    });
    
    document.getElementById('quiz-review').style.display = 'block';
    document.getElementById('show-review-btn').textContent = 'Hide Review';
    document.getElementById('show-review-btn').setAttribute('onclick', 'hideQuizReview()');
}

function hideQuizReview() {
    document.getElementById('quiz-review').style.display = 'none';
    document.getElementById('show-review-btn').textContent = 'Show Review';
    document.getElementById('show-review-btn').setAttribute('onclick', 'showQuizReview()');
}

function retakeQuiz() {
    // Reset quiz state
    currentQuestionIndex = 0;
    userAnswers = new Array(currentQuiz.length).fill(null);
    quizScore = 0;
    
    // Show quiz interface
    document.getElementById('quiz-results').style.display = 'none';
    document.getElementById('quiz-interface').style.display = 'block';
    
    // Display first question
    displayQuestion();
}

// Utility function to shuffle array
function shuffleArray(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}
// AI Code Generator Functions

// Generate code based on selected operations and language
function generateCode() {
    const language = document.getElementById('code-language').value;
    const selectedOperations = getSelectedOperations();
    
    if (selectedOperations.length === 0) {
        alert('Please select at least one vector operation.');
        return;
    }
    
    // Generate code based on language and operations
    let code = '';
    
    switch(language) {
        case 'c':
            code = generateCCode(selectedOperations);
            break;
        case 'cpp':
            code = generateCppCode(selectedOperations);
            break;
        case 'java':
            code = generateJavaCode(selectedOperations);
            break;
        case 'python':
            code = generatePythonCode(selectedOperations);
            break;
    }
    
    // Display the code
    document.getElementById('generated-code').textContent = code;
    document.getElementById('code-output').style.display = 'block';
    document.getElementById('code-test-interface').style.display = 'block';
    
    // Generate test inputs based on selected operations
    generateTestInputs(selectedOperations);
}

// Get selected operations from checkboxes
function getSelectedOperations() {
    const operations = [];
    const checkboxes = [
        'code-vector-add', 'code-vector-sub', 'code-scalar-mul', 
        'code-dot-product', 'code-cross-product', 'code-vector-magnitude',
        'code-vector-normalize', 'code-scalar-triple'
    ];
    
    checkboxes.forEach(id => {
        if (document.getElementById(id).checked) {
            operations.push(id.replace('code-', ''));
        }
    });
    
    return operations;
}

// Generate test inputs based on selected operations
function generateTestInputs(operations) {
    const testInputsDiv = document.getElementById('test-inputs');
    testInputsDiv.innerHTML = '';
    
    operations.forEach(op => {
        switch(op) {
            case 'vector-add':
            case 'vector-sub':
                testInputsDiv.innerHTML += `
                    <div class="mb-2">
                        <label>Vector A (comma-separated):</label>
                        <input type="text" class="form-control vector-a" value="1,2,3">
                    </div>
                    <div class="mb-2">
                        <label>Vector B (comma-separated):</label>
                        <input type="text" class="form-control vector-b" value="4,5,6">
                    </div>
                `;
                break;
            case 'scalar-mul':
                testInputsDiv.innerHTML += `
                    <div class="mb-2">
                        <label>Vector (comma-separated):</label>
                        <input type="text" class="form-control vector-a" value="1,2,3">
                    </div>
                    <div class="mb-2">
                        <label>Scalar:</label>
                        <input type="number" class="form-control scalar" value="2">
                    </div>
                `;
                break;
            case 'dot-product':
                testInputsDiv.innerHTML += `
                    <div class="mb-2">
                        <label>Vector A (comma-separated):</label>
                        <input type="text" class="form-control vector-a" value="1,2,3">
                    </div>
                    <div class="mb-2">
                        <label>Vector B (comma-separated):</label>
                        <input type="text" class="form-control vector-b" value="4,5,6">
                    </div>
                `;
                break;
            case 'cross-product':
                testInputsDiv.innerHTML += `
                    <div class="mb-2">
                        <label>Vector A (comma-separated):</label>
                        <input type="text" class="form-control vector-a" value="1,2,3">
                    </div>
                    <div class="mb-2">
                        <label>Vector B (comma-separated):</label>
                        <input type="text" class="form-control vector-b" value="4,5,6">
                    </div>
                `;
                break;
            case 'vector-magnitude':
                testInputsDiv.innerHTML += `
                    <div class="mb-2">
                        <label>Vector (comma-separated):</label>
                        <input type="text" class="form-control vector-a" value="3,4,0">
                    </div>
                `;
                break;
            case 'vector-normalize':
                testInputsDiv.innerHTML += `
                    <div class="mb-2">
                        <label>Vector (comma-separated):</label>
                        <input type="text" class="form-control vector-a" value="3,4,0">
                    </div>
                `;
                break;
            case 'scalar-triple':
                testInputsDiv.innerHTML += `
                    <div class="mb-2">
                        <label>Vector A (comma-separated):</label>
                        <input type="text" class="form-control vector-a" value="1,0,0">
                    </div>
                    <div class="mb-2">
                        <label>Vector B (comma-separated):</label>
                        <input type="text" class="form-control vector-b" value="0,1,0">
                    </div>
                    <div class="mb-2">
                        <label>Vector C (comma-separated):</label>
                        <input type="text" class="form-control vector-c" value="0,0,1">
                    </div>
                `;
                break;
        }
    });
}

// Test the generated code with custom inputs
function runCodeTest() {
    const language = document.getElementById('code-language').value;
    const selectedOperations = getSelectedOperations();
    const testResultsDiv = document.getElementById('test-results');
    
    testResultsDiv.innerHTML = '<p class="ai-thinking">Running tests...</p>';
    
    // Simulate test execution (in a real implementation, this would run the actual code)
    setTimeout(() => {
        let testResults = '<h6>Test Results:</h6>';
        
        selectedOperations.forEach(op => {
            testResults += `<div class="step-explanation"><strong>${formatOperationName(op)}:</strong> `;
            
            switch(op) {
                case 'vector-add':
                    const vecA = document.querySelector('.vector-a').value.split(',').map(Number);
                    const vecB = document.querySelector('.vector-b').value.split(',').map(Number);
                    const addResult = vecA.map((val, i) => val + vecB[i]);
                    testResults += `Result: [${addResult.join(', ')}]</div>`;
                    break;
                    
                case 'vector-sub':
                    const vecA2 = document.querySelector('.vector-a').value.split(',').map(Number);
                    const vecB2 = document.querySelector('.vector-b').value.split(',').map(Number);
                    const subResult = vecA2.map((val, i) => val - vecB2[i]);
                    testResults += `Result: [${subResult.join(', ')}]</div>`;
                    break;
                    
                case 'scalar-mul':
                    const vec = document.querySelector('.vector-a').value.split(',').map(Number);
                    const scalar = parseFloat(document.querySelector('.scalar').value);
                    const mulResult = vec.map(val => val * scalar);
                    testResults += `Result: [${mulResult.join(', ')}]</div>`;
                    break;
                    
                case 'dot-product':
                    const vecA3 = document.querySelector('.vector-a').value.split(',').map(Number);
                    const vecB3 = document.querySelector('.vector-b').value.split(',').map(Number);
                    const dotResult = vecA3.reduce((sum, val, i) => sum + val * vecB3[i], 0);
                    testResults += `Result: ${dotResult}</div>`;
                    break;
                    
                case 'cross-product':
                    const vecA4 = document.querySelector('.vector-a').value.split(',').map(Number);
                    const vecB4 = document.querySelector('.vector-b').value.split(',').map(Number);
                    const crossX = vecA4[1] * vecB4[2] - vecA4[2] * vecB4[1];
                    const crossY = vecA4[2] * vecB4[0] - vecA4[0] * vecB4[2];
                    const crossZ = vecA4[0] * vecB4[1] - vecA4[1] * vecB4[0];
                    testResults += `Result: [${crossX}, ${crossY}, ${crossZ}]</div>`;
                    break;
                    
                case 'vector-magnitude':
                    const vec5 = document.querySelector('.vector-a').value.split(',').map(Number);
                    const magnitude = Math.sqrt(vec5.reduce((sum, val) => sum + val * val, 0));
                    testResults += `Result: ${magnitude.toFixed(4)}</div>`;
                    break;
                    
                case 'vector-normalize':
                    const vec6 = document.querySelector('.vector-a').value.split(',').map(Number);
                    const mag = Math.sqrt(vec6.reduce((sum, val) => sum + val * val, 0));
                    const normalized = mag !== 0 ? vec6.map(val => val / mag) : vec6;
                    testResults += `Result: [${normalized.map(v => v.toFixed(4)).join(', ')}]</div>`;
                    break;
                    
                case 'scalar-triple':
                    const vecA7 = document.querySelector('.vector-a').value.split(',').map(Number);
                    const vecB7 = document.querySelector('.vector-b').value.split(',').map(Number);
                    const vecC7 = document.querySelector('.vector-c').value.split(',').map(Number);
                    
                    // A · (B × C)
                    const crossX2 = vecB7[1] * vecC7[2] - vecB7[2] * vecC7[1];
                    const crossY2 = vecB7[2] * vecC7[0] - vecB7[0] * vecC7[2];
                    const crossZ2 = vecB7[0] * vecC7[1] - vecB7[1] * vecC7[0];
                    
                    const tripleProduct = vecA7[0] * crossX2 + vecA7[1] * crossY2 + vecA7[2] * crossZ2;
                    testResults += `Result: ${tripleProduct}</div>`;
                    break;
            }
        });
        
        testResultsDiv.innerHTML = testResults;
    }, 1000);
}

// Format operation name for display
function formatOperationName(op) {
    return op.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
}

// Copy code to clipboard
function copyCode() {
    const codeElement = document.getElementById('generated-code');
    const textArea = document.createElement('textarea');
    textArea.value = codeElement.textContent;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    alert('Code copied to clipboard!');
}

// Test the generated code with custom inputs
function testGeneratedCode() {
    // This would be implemented to actually run the code in the selected language
    // For this demo, we'll just show a message
    alert('In a full implementation, this would execute the generated code with your inputs. For this demo, we show simulated results.');
    runCodeTest();
}

// Code Generation Functions for Different Languages

function generateCCode(operations) {
    let code = `#include <stdio.h>
#include <math.h>

// Vector structure
typedef struct {
    double x, y, z;
} Vector;

Vector vector_normalize(Vector a);
double vector_magnitude(Vector a);
// Function declarations\n`;

    if (operations.includes('vector-add')) {
        code += `Vector vector_add(Vector a, Vector b);\n`;
    }
    if (operations.includes('vector-sub')) {
        code += `Vector vector_sub(Vector a, Vector b);\n`;
    }
    if (operations.includes('scalar-mul')) {
        code += `Vector scalar_mul(Vector a, double scalar);\n`;
    }
    if (operations.includes('dot-product')) {
        code += `double dot_product(Vector a, Vector b);\n`;
    }
    if (operations.includes('cross-product')) {
        code += `Vector cross_product(Vector a, Vector b);\n`;
    }
    if (operations.includes('vector-magnitude')) {
        code += `double vector_magnitude(Vector a);\n`;
    }
    if (operations.includes('vector-normalize')) {
        code += `Vector vector_normalize(Vector a);\n`;
    }
    if (operations.includes('scalar-triple')) {
        code += `double scalar_triple_product(Vector a, Vector b, Vector c);\n`;
    }

    code += `\nint main() {\n    // Example usage\n    Vector v1 = {1, 2, 3};\n    Vector v2 = {4, 5, 6};\n    \n    printf("Vector operations:\\n");\n`;

    operations.forEach(op => {
        switch(op) {
            case 'vector-add':
                code += `    Vector add_result = vector_add(v1, v2);\n    printf("Addition: (%.2f, %.2f, %.2f)\\n", add_result.x, add_result.y, add_result.z);\n`;
                break;
            case 'vector-sub':
                code += `    Vector sub_result = vector_sub(v1, v2);\n    printf("Subtraction: (%.2f, %.2f, %.2f)\\n", sub_result.x, sub_result.y, sub_result.z);\n`;
                break;
            case 'scalar-mul':
                code += `    Vector mul_result = scalar_mul(v1, 2.0);\n    printf("Scalar multiplication: (%.2f, %.2f, %.2f)\\n", mul_result.x, mul_result.y, mul_result.z);\n`;
                break;
            case 'dot-product':
                code += `    double dot_result = dot_product(v1, v2);\n    printf("Dot product: %.2f\\n", dot_result);\n`;
                break;
            case 'cross-product':
                code += `    Vector cross_result = cross_product(v1, v2);\n    printf("Cross product: (%.2f, %.2f, %.2f)\\n", cross_result.x, cross_result.y, cross_result.z);\n`;
                break;
            case 'vector-magnitude':
                code += `    double mag_result = vector_magnitude(v1);\n    printf("Magnitude of v1: %.2f\\n", mag_result);\n`;
                break;
            case 'vector-normalize':
                code += `    Vector norm_result = vector_normalize(v1);\n    printf("Normalized v1: (%.2f, %.2f, %.2f)\\n", norm_result.x, norm_result.y, norm_result.z);\n`;
                break;
            case 'scalar-triple':
                code += `    Vector v3 = {0, 0, 1};\n    double triple_result = scalar_triple_product(v1, v2, v3);\n    printf("Scalar triple product: %.2f\\n", triple_result);\n`;
                break;
        }
    });

    code += `    \n    return 0;\n}\n\n`;

    // Function implementations
    operations.forEach(op => {
        switch(op) {
            case 'vector-add':
                code += `Vector vector_add(Vector a, Vector b) {\n    return (Vector){a.x + b.x, a.y + b.y, a.z + b.z};\n}\n\n`;
                break;
            case 'vector-sub':
                code += `Vector vector_sub(Vector a, Vector b) {\n    return (Vector){a.x - b.x, a.y - b.y, a.z - b.z};\n}\n\n`;
                break;
            case 'scalar-mul':
                code += `Vector scalar_mul(Vector a, double scalar) {\n    return (Vector){a.x * scalar, a.y * scalar, a.z * scalar};\n}\n\n`;
                break;
            case 'dot-product':
                code += `double dot_product(Vector a, Vector b) {\n    return a.x * b.x + a.y * b.y + a.z * b.z;\n}\n\n`;
                break;
            case 'cross-product':
                code += `Vector cross_product(Vector a, Vector b) {\n    return (Vector){\n        a.y * b.z - a.z * b.y,\n        a.z * b.x - a.x * b.z,\n        a.x * b.y - a.y * b.x\n    };\n}\n\n`;
                break;
            case 'vector-magnitude':
                code += `double vector_magnitude(Vector a) {\n    return sqrt(a.x * a.x + a.y * a.y + a.z * a.z);\n}\n\n`;
                break;
            case 'vector-normalize':
                code += ` // Function to calculate the magnitude of a vector
double vector_magnitude(Vector a) {
    return sqrt(a.x * a.x + a.y * a.y + a.z * a.z);
}
Vector vector_normalize(Vector a) {\n    double mag = vector_magnitude(a);\n    if (mag == 0) return a;\n    return (Vector){a.x / mag, a.y / mag, a.z / mag};\n}\n\n`;
                break;
            case 'scalar-triple':
                code += `double scalar_triple_product(Vector a, Vector b, Vector c) {\n    return dot_product(a, cross_product(b, c));\n}\n\n`;
                break;
        }
    });

    return code;
}

function generateCppCode(operations) {
    let code = `#include <iostream>
#include <cmath>
#include <vector>

using namespace std;

// Vector class
class Vector3D {
private:
    double x, y, z;
    
public:
    Vector3D(double x = 0, double y = 0, double z = 0) : x(x), y(y), z(z) {}\n`;

    if (operations.includes('vector-add')) {
        code += `    Vector3D operator+(const Vector3D& other) const {\n        return Vector3D(x + other.x, y + other.y, z + other.z);\n    }\n`;
    }
    if (operations.includes('vector-sub')) {
        code += `    Vector3D operator-(const Vector3D& other) const {\n        return Vector3D(x - other.x, y - other.y, z - other.z);\n    }\n`;
    }
    if (operations.includes('scalar-mul')) {
        code += `    Vector3D operator*(double scalar) const {\n        return Vector3D(x * scalar, y * scalar, z * scalar);\n    }\n`;
    }
    if (operations.includes('dot-product')) {
        code += `    double dot(const Vector3D& other) const {\n        return x * other.x + y * other.y + z * other.z;\n    }\n`;
    }
    if (operations.includes('cross-product')) {
        code += `    Vector3D cross(const Vector3D& other) const {\n        return Vector3D(\n            y * other.z - z * other.y,\n            z * other.x - x * other.z,\n            x * other.y - y * other.x\n        );\n    }\n`;
    }
    if (operations.includes('vector-magnitude')) {
        code += `    double magnitude() const {\n        return sqrt(x*x + y*y + z*z);\n    }\n`;
    }
    if (operations.includes('vector-normalize')) {
        code += `  
        double magnitude() const
         {
        return sqrt(x * x + y * y + z * z);
         }      
        Vector3D normalize() const {\n        double mag = magnitude();\n        if (mag == 0) return *this;\n        return Vector3D(x/mag, y/mag, z/mag);\n    }\n`;
    }

    code += `    \n    void print() const {\n        cout << "(" << x << ", " << y << ", " << z << ")";\n    }\n};\n\n`;

    if (operations.includes('scalar-triple')) {
        code += `double scalarTripleProduct(const Vector3D& a, const Vector3D& b, const Vector3D& c) {\n    return a.dot(b.cross(c));\n}\n\n`;
    }

    code += `int main() {\n    Vector3D v1(1, 2, 3);\n    Vector3D v2(4, 5, 6);\n    \n    cout << "Vector operations:" << endl;\n`;

    operations.forEach(op => {
        switch(op) {
            case 'vector-add':
                code += `    Vector3D add_result = v1 + v2;\n    cout << "Addition: "; add_result.print(); cout << endl;\n`;
                break;
            case 'vector-sub':
                code += `    Vector3D sub_result = v1 - v2;\n    cout << "Subtraction: "; sub_result.print(); cout << endl;\n`;
                break;
            case 'scalar-mul':
                code += `    Vector3D mul_result = v1 * 2.0;\n    cout << "Scalar multiplication: "; mul_result.print(); cout << endl;\n`;
                break;
            case 'dot-product':
                code += `    double dot_result = v1.dot(v2);\n    cout << "Dot product: " << dot_result << endl;\n`;
                break;
            case 'cross-product':
                code += `    Vector3D cross_result = v1.cross(v2);\n    cout << "Cross product: "; cross_result.print(); cout << endl;\n`;
                break;
            case 'vector-magnitude':
                code += `    double mag_result = v1.magnitude();\n    cout << "Magnitude of v1: " << mag_result << endl;\n`;
                break;
            case 'vector-normalize':
                code += `    Vector3D norm_result = v1.normalize();\n    cout << "Normalized v1: "; norm_result.print(); cout << endl;\n`;
                break;
            case 'scalar-triple':
                code += `    Vector3D v3(0, 0, 1);\n    double triple_result = scalarTripleProduct(v1, v2, v3);\n    cout << "Scalar triple product: " << triple_result << endl;\n`;
                break;
        }
    });

    code += `    \n    return 0;\n}`;

    return code;
}

function generateJavaCode(operations) {
    let code = `public class VectorOperations {\n    \n    // Vector class\n    static class Vector3D {\n        private double x, y, z;\n        \n        public Vector3D(double x, double y, double z) {\n            this.x = x;\n            this.y = y;\n            this.z = z;\n        }\n`;

    if (operations.includes('vector-add')) {
        code += `        public Vector3D add(Vector3D other) {\n            return new Vector3D(x + other.x, y + other.y, z + other.z);\n        }\n`;
    }
    if (operations.includes('vector-sub')) {
        code += `        public Vector3D subtract(Vector3D other) {\n            return new Vector3D(x - other.x, y - other.y, z - other.z);\n        }\n`;
    }
    if (operations.includes('scalar-mul')) {
        code += `        public Vector3D multiply(double scalar) {\n            return new Vector3D(x * scalar, y * scalar, z * scalar);\n        }\n`;
    }
    if (operations.includes('dot-product')) {
        code += `        public double dot(Vector3D other) {\n            return x * other.x + y * other.y + z * other.z;\n        }\n`;
    }
    if (operations.includes('cross-product')) {
        code += `        public Vector3D cross(Vector3D other) {\n            return new Vector3D(\n                y * other.z - z * other.y,\n                z * other.x - x * other.z,\n                x * other.y - y * other.x\n            );\n        }\n`;
    }
    if (operations.includes('vector-magnitude')) {
        code += `        public double magnitude() {\n            return Math.sqrt(x*x + y*y + z*z);\n        }\n`;
    }
    if (operations.includes('vector-normalize')) {
        code += `     public double magnitude() 
        {
            return Math.sqrt(x * x + y * y + z * z);
        }    
            public Vector3D normalize() {\n            double mag = magnitude();\n            if (mag == 0) return this;\n            return new Vector3D(x/mag, y/mag, z/mag);\n        }\n`;
    }

    code += `        \n        @Override\n        public String toString() {\n            return String.format("(%.2f, %.2f, %.2f)", x, y, z);\n        }\n    }\n\n`;

    if (operations.includes('scalar-triple')) {
        code += `    public static double scalarTripleProduct(Vector3D a, Vector3D b, Vector3D c) {\n        return a.dot(b.cross(c));\n    }\n\n`;
    }

    code += `    public static void main(String[] args) {\n        Vector3D v1 = new Vector3D(1, 2, 3);\n        Vector3D v2 = new Vector3D(4, 5, 6);\n        \n        System.out.println("Vector operations:");\n`;

    operations.forEach(op => {
        switch(op) {
            case 'vector-add':
                code += `        Vector3D addResult = v1.add(v2);\n        System.out.println("Addition: " + addResult);\n`;
                break;
            case 'vector-sub':
                code += `        Vector3D subResult = v1.subtract(v2);\n        System.out.println("Subtraction: " + subResult);\n`;
                break;
            case 'scalar-mul':
                code += `        Vector3D mulResult = v1.multiply(2.0);\n        System.out.println("Scalar multiplication: " + mulResult);\n`;
                break;
            case 'dot-product':
                code += `        double dotResult = v1.dot(v2);\n        System.out.println("Dot product: " + dotResult);\n`;
                break;
            case 'cross-product':
                code += `        Vector3D crossResult = v1.cross(v2);\n        System.out.println("Cross product: " + crossResult);\n`;
                break;
            case 'vector-magnitude':
                code += `        double magResult = v1.magnitude();\n        System.out.println("Magnitude of v1: " + magResult);\n`;
                break;
            case 'vector-normalize':
                code += `        Vector3D normResult = v1.normalize();\n        System.out.println("Normalized v1: " + normResult);\n`;
                break;
            case 'scalar-triple':
                code += `        Vector3D v3 = new Vector3D(0, 0, 1);\n        double tripleResult = scalarTripleProduct(v1, v2, v3);\n        System.out.println("Scalar triple product: " + tripleResult);\n`;
                break;
        }
    });

    code += `    }\n}`;

    return code;
}

function generatePythonCode(operations) {
    let code = `import math\n\nclass Vector3D:\n    def __init__(self, x=0, y=0, z=0):\n        self.x = x\n        self.y = y\n        self.z = z\n`;

    if (operations.includes('vector-add')) {
        code += `    def __add__(self, other):\n        return Vector3D(self.x + other.x, self.y + other.y, self.z + other.z)\n`;
    }
    if (operations.includes('vector-sub')) {
        code += `    def __sub__(self, other):\n        return Vector3D(self.x - other.x, self.y - other.y, self.z - other.z)\n`;
    }
    if (operations.includes('scalar-mul')) {
        code += `    def __mul__(self, scalar):\n        return Vector3D(self.x * scalar, self.y * scalar, self.z * scalar)\n`;
    }
    if (operations.includes('dot-product')) {
        code += `    def dot(self, other):\n        return self.x * other.x + self.y * other.y + self.z * other.z\n`;
    }
    if (operations.includes('cross-product')) {
        code += `    def cross(self, other):\n        return Vector3D(\n            self.y * other.z - self.z * other.y,\n            self.z * other.x - self.x * other.z,\n            self.x * other.y - self.y * other.x\n        )\n`;
    }
    if (operations.includes('vector-magnitude')) {
        code += `    def magnitude(self):\n        return math.sqrt(self.x**2 + self.y**2 + self.z**2)\n`;
    }
if (operations.includes('vector-normalize')) {
        code += `    def magnitude(self):\n        return math.sqrt(self.x**2 + self.y**2 + self.z**2)\n\n`;
        code += `    def normalize(self):\n        mag = self.magnitude()\n        if mag == 0:\n            return self\n        return Vector3D(self.x/mag, self.y/mag, self.z/mag)\n`;
    }

    code += `    \n    def __str__(self):\n        return f"({self.x}, {self.y}, {self.z})"\n\n`;

    if (operations.includes('scalar-triple')) {
        code += `def scalar_triple_product(a, b, c):\n    return a.dot(b.cross(c))\n\n`;
    }

    code += `if __name__ == "__main__":\n    v1 = Vector3D(1, 2, 3)\n    v2 = Vector3D(4, 5, 6)\n    \n    print("Vector operations:")\n`;

    operations.forEach(op => {
        switch(op) {
            case 'vector-add':
                code += `    add_result = v1 + v2\n    print(f"Addition: {add_result}")\n`;
                break;
            case 'vector-sub':
                code += `    sub_result = v1 - v2\n    print(f"Subtraction: {sub_result}")\n`;
                break;
            case 'scalar-mul':
                code += `    mul_result = v1 * 2.0\n    print(f"Scalar multiplication: {mul_result}")\n`;
                break;
            case 'dot-product':
                code += `    dot_result = v1.dot(v2)\n    print(f"Dot product: {dot_result}")\n`;
                break;
            case 'cross-product':
                code += `    cross_result = v1.cross(v2)\n    print(f"Cross product: {cross_result}")\n`;
                break;
            case 'vector-magnitude':
                code += `    mag_result = v1.magnitude()\n    print(f"Magnitude of v1: {mag_result}")\n`;
                break;
            case 'vector-normalize':
                code += `    norm_result = v1.normalize()\n    print(f"Normalized v1: {norm_result}")\n`;
                break;
            case 'scalar-triple':
                code += `    v3 = Vector3D(0, 0, 1)\n    triple_result = scalar_triple_product(v1, v2, v3)\n    print(f"Scalar triple product: {triple_result}")\n`;
                break;
        }
    });

    return code;
}
// Real-Time Feedback System
let feedbackEnabled = true;
let currentContext = '';
let hintLevel = 0;
let userMistakes = {};

// Initialize feedback system
function initFeedbackSystem() {
    // Set up event listeners for all input fields
    const inputFields = document.querySelectorAll('input[type="number"]');
    inputFields.forEach(input => {
        input.addEventListener('input', debounce(validateInput, 500));
        input.addEventListener('blur', validateInput);
    });
    
    // Set up tab change listener to update context
    document.querySelectorAll('button[data-bs-toggle="tab"]').forEach(tab => {
        tab.addEventListener('shown.bs.tab', function(event) {
            updateContext(event.target.id);
            resetHintLevel();
        });
    });
    
    // Initialize with current tab
    const activeTab = document.querySelector('.nav-tabs .nav-link.active').id;
    updateContext(activeTab);
    
    // Toggle feedback system
    document.getElementById('enable-feedback').addEventListener('change', function() {
        feedbackEnabled = this.checked;
        document.getElementById('feedback-container').style.display = 
            feedbackEnabled ? 'block' : 'none';
    });
    
    // Show feedback container if enabled
    if (feedbackEnabled) {
        document.getElementById('feedback-container').style.display = 'block';
    }
}

// Update current context based on active tab
function updateContext(tabId) {
    const contextMap = {
        'work-tab': 'work',
        'area-tab': 'area',
        'torque-tab': 'torque',
        'normal-tab': 'normal',
        'velocity-tab': 'velocity',
        'line-tab': 'line',
        'linear-tab': 'linear',
        'normalization-tab': 'normalization',
        'equilibrium-tab': 'equilibrium',
        'distance-tab': 'distance'
    };
    
    currentContext = contextMap[tabId] || 'general';
    updateFeedbackMessage(`Now working on: ${getContextName(currentContext)}. I'll provide hints as you work.`);
}

// Get display name for context
function getContextName(context) {
    const names = {
        'work': 'Work Calculation',
        'area': 'Area of Parallelogram',
        'torque': 'Torque Calculation',
        'normal': 'Normal Vectors',
        'velocity': 'Resultant Velocity',
        'line': 'Vector Equation of a Line',
        'linear': 'Linear Velocity',
        'normalization': 'Vector Normalization',
        'equilibrium': 'Equilibrium of Forces',
        'distance': 'Distance to a Plane'
    };
    return names[context] || 'Vector Physics';
}

// Validate input and provide feedback
function validateInput(event) {
    if (!feedbackEnabled) return;
    
    const input = event.target;
    const value = parseFloat(input.value);
    const fieldId = input.id;
    
    // Skip if empty or invalid
    if (isNaN(value)) return;
    
    // Context-specific validation
    let feedback = '';
    let isError = false;
    
    switch(currentContext) {
        case 'work':
            feedback = validateWorkInput(fieldId, value);
            break;
        case 'torque':
            feedback = validateTorqueInput(fieldId, value);
            break;
        case 'area':
            feedback = validateAreaInput(fieldId, value);
            break;
        case 'normal':
            feedback = validateNormalInput(fieldId, value);
            break;
        case 'equilibrium':
            feedback = validateEquilibriumInput(fieldId, value);
            break;
        // Add more cases as needed
    }
    
    if (feedback) {
        isError = feedback.includes('Error') || feedback.includes('Warning');
        updateFeedbackMessage(feedback, isError);
        
        // Track mistakes for personalized hints
        if (isError && !userMistakes[fieldId]) {
            userMistakes[fieldId] = 1;
        } else if (isError) {
            userMistakes[fieldId]++;
        }
    }
}

// Work calculation validation
function validateWorkInput(fieldId, value) {
    if (fieldId.includes('force') || fieldId.includes('displacement')) {
        // Check for zero vectors
        const forceX = parseFloat(document.getElementById('force-x').value) || 0;
        const forceY = parseFloat(document.getElementById('force-y').value) || 0;
        const forceZ = parseFloat(document.getElementById('force-z').value) || 0;
        
        const dispX = parseFloat(document.getElementById('displacement-x').value) || 0;
        const dispY = parseFloat(document.getElementById('displacement-y').value) || 0;
        const dispZ = parseFloat(document.getElementById('displacement-z').value) || 0;
        
        const forceMag = Math.sqrt(forceX*forceX + forceY*forceY + forceZ*forceZ);
        const dispMag = Math.sqrt(dispX*dispX + dispY*dispY + dispZ*dispZ);
        
        if (forceMag === 0 && (fieldId.includes('force'))) {
            return "Warning: Force vector has zero magnitude. Work will be zero regardless of displacement.";
        }
        
        if (dispMag === 0 && (fieldId.includes('displacement'))) {
            return "Warning: Displacement vector has zero magnitude. No work is done if there's no displacement.";
        }
        
        // Check for perpendicular vectors (work = 0)
        if (forceMag > 0 && dispMag > 0) {
            const dotProduct = forceX*dispX + forceY*dispY + forceZ*dispZ;
            const cosTheta = dotProduct / (forceMag * dispMag);
            
            if (Math.abs(cosTheta) < 0.1) {
                return "Hint: Force and displacement appear nearly perpendicular. Work will be close to zero.";
            }
        }
    }
    
    return '';
}

// Torque calculation validation
function validateTorqueInput(fieldId, value) {
    if (fieldId.includes('position') || fieldId.includes('torque-force')) {
        // Check if position vector is from pivot point
        if (fieldId.includes('position') && value !== 0) {
            return "Remember: The position vector should start from the pivot point (usually origin).";
        }
        
        // Check for parallel vectors (torque = 0)
        const posX = parseFloat(document.getElementById('position-x').value) || 0;
        const posY = parseFloat(document.getElementById('position-y').value) || 0;
        const posZ = parseFloat(document.getElementById('position-z').value) || 0;
        
        const forceX = parseFloat(document.getElementById('torque-force-x').value) || 0;
        const forceY = parseFloat(document.getElementById('torque-force-y').value) || 0;
        const forceZ = parseFloat(document.getElementById('torque-force-z').value) || 0;
        
        // Simple check for parallel vectors (cross product ≈ 0)
        if (posX/forceX === posY/forceY && posY/forceY === posZ/forceZ && 
            forceX !== 0 && forceY !== 0 && forceZ !== 0) {
            return "Warning: Position and force vectors appear parallel. Torque will be zero.";
        }
    }
    
    return '';
}

// Area calculation validation
function validateAreaInput(fieldId, value) {
    if (fieldId.includes('vector-a') || fieldId.includes('vector-b')) {
        // Check for parallel vectors (area = 0)
        const aX = parseFloat(document.getElementById('vector-a-x').value) || 0;
        const aY = parseFloat(document.getElementById('vector-a-y').value) || 0;
        const aZ = parseFloat(document.getElementById('vector-a-z').value) || 0;
        
        const bX = parseFloat(document.getElementById('vector-b-x').value) || 0;
        const bY = parseFloat(document.getElementById('vector-b-y').value) || 0;
        const bZ = parseFloat(document.getElementById('vector-b-z').value) || 0;
        
        // Simple parallel check
        if (aX/bX === aY/bY && aY/bY === aZ/bZ && bX !== 0 && bY !== 0 && bZ !== 0) {
            return "Warning: Vectors appear parallel. Area of parallelogram will be zero.";
        }
    }
    
    return '';
}

// Normal vector validation
function validateNormalInput(fieldId, value) {
    if (fieldId.includes('normal-u') || fieldId.includes('normal-v')) {
        // Check for parallel vectors (normal = 0)
        const uX = parseFloat(document.getElementById('normal-u-x').value) || 0;
        const uY = parseFloat(document.getElementById('normal-u-y').value) || 0;
        const uZ = parseFloat(document.getElementById('normal-u-z').value) || 0;
        
        const vX = parseFloat(document.getElementById('normal-v-x').value) || 0;
        const vY = parseFloat(document.getElementById('normal-v-y').value) || 0;
        const vZ = parseFloat(document.getElementById('normal-v-z').value) || 0;
        
        // Simple parallel check
        if (uX/vX === uY/vY && uY/vY === uZ/vZ && vX !== 0 && vY !== 0 && vZ !== 0) {
            return "Error: Vectors are parallel. Cannot define a unique normal vector.";
        }
    }
    
    return '';
}

// Equilibrium validation
function validateEquilibriumInput(fieldId, value) {
    // Check if system is approaching equilibrium
    const forceInputs = document.querySelectorAll('.force-input-group');
    let resultantX = 0, resultantY = 0, resultantZ = 0;
    
    forceInputs.forEach((inputGroup) => {
        const x = parseFloat(inputGroup.querySelector('.force-x').value) || 0;
        const y = parseFloat(inputGroup.querySelector('.force-y').value) || 0;
        const z = parseFloat(inputGroup.querySelector('.force-z').value) || 0;
        
        resultantX += x;
        resultantY += y;
        resultantZ += z;
    });
    
    const magnitude = Math.sqrt(resultantX*resultantX + resultantY*resultantY + resultantZ*resultantZ);
    
    if (magnitude < 0.5 && magnitude > 0.1) {
        return "Hint: Resultant force is small. You're close to equilibrium!";
    }
    
    if (magnitude < 0.1) {
        return "Success: System is in equilibrium (resultant ≈ 0)!";
    }
    
    return '';
}

// Update feedback message
function updateFeedbackMessage(message, isError = false) {
    const feedbackElement = document.getElementById('feedback-message');
    feedbackElement.textContent = message;
    feedbackElement.style.color = isError ? '#e74c3c' : '#2c3e50';
    
    // Auto-hide non-error messages after 10 seconds
    if (!isError) {
        setTimeout(() => {
            if (feedbackElement.textContent === message) {
                feedbackElement.textContent = 'Continue working. I\'ll provide hints as needed.';
                feedbackElement.style.color = '#2c3e50';
            }
        }, 10000);
    }
}

// Request a hint based on current context and user mistakes
function requestHint() {
    hintLevel = (hintLevel % 3) + 1; // Cycle through 3 hint levels
    
    let hint = '';
    
    switch(currentContext) {
        case 'work':
            hint = getWorkHint(hintLevel);
            break;
        case 'torque':
            hint = getTorqueHint(hintLevel);
            break;
        case 'area':
            hint = getAreaHint(hintLevel);
            break;
        case 'normal':
            hint = getNormalHint(hintLevel);
            break;
        case 'equilibrium':
            hint = getEquilibriumHint(hintLevel);
            break;
        default:
            hint = "Try reviewing the basic vector operations for this concept.";
    }
    
    updateFeedbackMessage(`Hint (Level ${hintLevel}/3): ${hint}`);
}

// Get work-specific hints
function getWorkHint(level) {
    switch(level) {
        case 1:
            return "Work is the dot product of force and displacement vectors: W = F·d";
        case 2:
            return "Remember: W = |F||d|cosθ, where θ is the angle between the vectors";
        case 3:
            return "Only the component of force in the direction of displacement does work";
        default:
            return "Check that your vectors are defined correctly";
    }
}

// Get torque-specific hints
function getTorqueHint(level) {
    switch(level) {
        case 1:
            return "Torque is the cross product of position and force vectors: τ = r × F";
        case 2:
            return "The position vector r should start from the pivot point";
        case 3:
            return "Maximum torque occurs when force is perpendicular to position vector";
        default:
            return "Ensure your position vector is measured from the pivot";
    }
}

// Get area-specific hints
function getAreaHint(level) {
    switch(level) {
        case 1:
            return "Area of parallelogram = |a × b| (magnitude of cross product)";
        case 2:
            return "The cross product gives a vector perpendicular to both a and b";
        case 3:
            return "For 2D vectors, area = |a_x·b_y - a_y·b_x|";
        default:
            return "Check that your vectors are not parallel";
    }
}

// Get normal vector hints
function getNormalHint(level) {
    switch(level) {
        case 1:
            return "Normal vector = u × v (cross product of two vectors in the plane)";
        case 2:
            return "The normal vector is perpendicular to the plane";
        case 3:
            return "Unit normal vector = n/|n| (divide by magnitude)";
        default:
            return "Make sure your vectors are not parallel";
    }
}

// Get equilibrium hints
function getEquilibriumHint(level) {
    switch(level) {
        case 1:
            return "For equilibrium, the vector sum of all forces must be zero: ΣF = 0";
        case 2:
            return "Check each component (x, y, z) separately: ΣF_x = 0, ΣF_y = 0, ΣF_z = 0";
        case 3:
            return "If the resultant is not zero, add a force equal and opposite to cancel it";
        default:
            return "Make sure to consider all forces acting on the system";
    }
}

// Explain the current concept in detail
function explainConcept() {
    let explanation = '';
    
    switch(currentContext) {
        case 'work':
            explanation = `
                <strong>Work in Physics:</strong>
                <ul>
                    <li>Work is done when a force causes displacement</li>
                    <li>It's a scalar quantity measured in Joules (J)</li>
                    <li>W = F·d = |F||d|cosθ</li>
                    <li>Only the component of force parallel to displacement does work</li>
                    <li>Work can be positive, negative, or zero</li>
                </ul>
            `;
            break;
        case 'torque':
            explanation = `
                <strong>Torque (Moment of Force):</strong>
                <ul>
                    <li>Torque causes rotational motion</li>
                    <li>It's a vector quantity measured in N·m</li>
                    <li>τ = r × F (cross product)</li>
                    <li>|τ| = |r||F|sinθ</li>
                    <li>Direction follows right-hand rule</li>
                </ul>
            `;
            break;
        case 'area':
            explanation = `
                <strong>Area of Parallelogram:</strong>
                <ul>
                    <li>Formed by two vectors a and b</li>
                    <li>Area = |a × b| (magnitude of cross product)</li>
                    <li>For 2D: Area = |a_x·b_y - a_y·b_x|</li>
                    <li>If vectors are parallel, area = 0</li>
                    <li>Maximum area when vectors are perpendicular</li>
                </ul>
            `;
            break;
        default:
            explanation = "Select a specific calculation to get a detailed explanation.";
    }
    
    updateFeedbackMessage(explanation);
}

// Reset hint level when context changes
function resetHintLevel() {
    hintLevel = 0;
}

// Debounce function to limit how often validation runs
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Initialize the feedback system when the page loads
window.addEventListener('load', initFeedbackSystem);
    </script>
</body>
</html>